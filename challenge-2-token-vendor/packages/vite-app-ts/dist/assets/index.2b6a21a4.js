import{aG as qr,aH as Kr,aI as Mn}from"./App.929567af.js";import{u as Q,i as Et,p as xn,e as Bn,s as In,a as se,r as Nn}from"./subscriptionManager.81a2878b.js";import{n as ee,j as Gn,d as ce,e as Dn,s as Wn,a as Vr,l as $n,b as Fn,c as Un,f as Hn}from"./elliptic.dc0ce62a.js";import{a_ as zn,a$ as Ct,b0 as qn,b1 as Kn}from"./Main.7fda9d8a.js";import"./main.4b445710.js";import"./vendor.1a767ab4.js";import"./index.dd4e9bf4.js";import"./index.ce36710c.js";import"./chunk-MTWSNRX5.47c61f42.js";import"./index.81f197fe.js";function jr(e,t){var r=typeof e=="string"?Object.assign({},Vn[e]):e;if(typeof r!="object")throw new Error("[Portis] illegal 'network' parameter. Read more about it here: https://docs.portis.io/#/configuration?id=network");if(!r.nodeUrl)throw new Error("[Portis] 'nodeUrl' is required. Read more about it here: https://docs.portis.io/#/configuration?id=network");if(t&&!r.gasRelayHubAddress)throw new Error("[Portis] can't find default gas relay hub for "+e);return typeof e=="string"&&!t&&delete r.gasRelayHubAddress,r}var Vn={mainnet:{nodeUrl:"https://mainnet.infura.io/v3/faa4639b090f46499f29d894da0551a0",chainId:"1",gasRelayHubAddress:"0xD216153c06E857cD7f72665E0aF1d7D82172F494"},ropsten:{nodeUrl:"https://ropsten.infura.io/v3/faa4639b090f46499f29d894da0551a0",chainId:"3",gasRelayHubAddress:"0xD216153c06E857cD7f72665E0aF1d7D82172F494"},rinkeby:{nodeUrl:"https://rinkeby.infura.io/v3/faa4639b090f46499f29d894da0551a0",chainId:"4",gasRelayHubAddress:"0xD216153c06E857cD7f72665E0aF1d7D82172F494"},goerli:{nodeUrl:"https://goerli.infura.io/v3/faa4639b090f46499f29d894da0551a0",chainId:"5"},ubiq:{nodeUrl:"https://rpc1.ubiqscan.io",chainId:"8"},thundercoreTestnet:{nodeUrl:"https://testnet-rpc.thundercore.com:8544",chainId:"18"},orchid:{nodeUrl:"https://public-node.rsk.co",chainId:"30"},orchidTestnet:{nodeUrl:"https://public-node.testnet.rsk.co",chainId:"31"},kovan:{nodeUrl:"https://kovan.infura.io/v3/faa4639b090f46499f29d894da0551a0",chainId:"42",gasRelayHubAddress:"0xD216153c06E857cD7f72665E0aF1d7D82172F494"},classic:{nodeUrl:"https://ethereumclassic.network",chainId:"61"},sokol:{nodeUrl:"https://sokol.poa.network",chainId:"77"},core:{nodeUrl:"https://core.poa.network",chainId:"99"},xdai:{nodeUrl:"https://dai.poa.network",chainId:"100",gasRelayHubAddress:"0xD216153c06E857cD7f72665E0aF1d7D82172F494"},thundercore:{nodeUrl:"https://mainnet-rpc.thundercore.com",chainId:"108"},fuse:{nodeUrl:"https://rpc.fusenet.io",chainId:"122"},lightstreams:{nodeUrl:"https://node.mainnet.lightstreams.io",chainId:"163"},matic:{nodeUrl:"https://rpc-mainnet.matic.network",chainId:"137"},maticMumbai:{nodeUrl:"https://rpc-mumbai.matic.today",chainId:"80001"},maticAlpha:{nodeUrl:"https://alpha.ethereum.matic.network",chainId:"4626"},maticTestnet:{nodeUrl:"https://testnet2.matic.network",chainId:"8995"}},Zr=function(){return!!(typeof window!="undefined"&&window.document)},At=!1;function Jr(){return new Promise(function(e,t){Zr()?At?e():["loaded","interactive","complete"].indexOf(document.readyState)>-1?(At=!0,e()):window.addEventListener("load",function(){At=!0,e()},!1):t()})}function Yr(){var e=location.hostname==="localhost"||location.hostname==="127.0.0.1",t=location.protocol==="https:",r=e||t;if(!r)throw`[Portis] Access to the WebCrypto API is restricted to secure origins.
If this is a development environment please use http://localhost:`+location.port+` instead.
Otherwise, please use an SSL certificate.`}var G={};Object.defineProperty(G,"__esModule",{value:!0});var Xr=G.default=G.ERR_NOT_IN_IFRAME=G.ERR_CONNECTION_TIMEOUT=G.ERR_CONNECTION_DESTROYED=void 0,Qr="handshake",en="handshake-reply",tn="call",Rt="reply",rn="fulfilled",Ot="rejected",D="message",jn="DataCloneError",te="ConnectionDestroyed";G.ERR_CONNECTION_DESTROYED=te;var ue="ConnectionTimeout";G.ERR_CONNECTION_TIMEOUT=ue;var Lt="NotInIframe";G.ERR_NOT_IN_IFRAME=Lt;var Zn={"http:":"80","https:":"443"},Jn=/^(https?:)?\/\/([^/:]+)(:(\d+))?/,$={ERR_CONNECTION_DESTROYED:te,ERR_CONNECTION_TIMEOUT:ue,ERR_NOT_IN_IFRAME:Lt,Promise:function(){try{return window?window.Promise:null}catch{return null}}(),debug:!1},Yn=function(){var e=0;return function(){return++e}}(),x=function(){if($.debug){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=console).log.apply(t,["[Penpal]"].concat(n))}},Xn=function(t){var r=document.location,n=Jn.exec(t),i,o,c;n?(i=n[1]?n[1]:r.protocol,o=n[2],c=n[4]):(i=r.protocol,o=r.hostname,c=r.port);var f=c&&c!==Zn[i]?":".concat(c):"";return"".concat(i,"//").concat(o).concat(f)},Mt=function(t){var r=[];return t(function(){r.forEach(function(n){n()})}),{then:function(i){r.push(i)}}},nn=function(t){var r=t.name,n=t.message,i=t.stack;return{name:r,message:n,stack:i}},Qn=function(t){var r=new Error;return Object.keys(t).forEach(function(n){return r[n]=t[n]}),r},an=function(t,r,n,i){var o=r.localName,c=r.local,f=r.remote,u=r.remoteOrigin,s=!1;x("".concat(o,": Connecting call sender"));var a=function(d){return function(){for(var h=arguments.length,p=new Array(h),v=0;v<h;v++)p[v]=arguments[v];if(x("".concat(o,": Sending ").concat(d,"() call")),s){var g=new Error("Unable to send ".concat(d,"() call due ")+"to destroyed connection");throw g.code=te,g}return new $.Promise(function(y,m){var b=Yn(),_=function w(T){if(T.source===f&&T.origin===u&&T.data.penpal===Rt&&T.data.id===b){x("".concat(o,": Received ").concat(d,"() reply")),c.removeEventListener(D,w);var S=T.data.returnValue;T.data.returnValueIsError&&(S=Qn(S)),(T.data.resolution===rn?y:m)(S)}};c.addEventListener(D,_),f.postMessage({penpal:tn,id:b,methodName:d,args:p},u)})}};i.then(function(){s=!0}),n.reduce(function(l,d){return l[d]=a(d),l},t)},on=function(t,r,n){var i=t.localName,o=t.local,c=t.remote,f=t.remoteOrigin,u=!1;x("".concat(i,": Connecting call receiver"));var s=function(l){if(l.source===c&&l.origin===f&&l.data.penpal===tn){var d=l.data,h=d.methodName,p=d.args,v=d.id;if(x("".concat(i,": Received ").concat(h,"() call")),h in r){var g=function(m){return function(b){if(x("".concat(i,": Sending ").concat(h,"() reply")),u){x("".concat(i,": Unable to send ").concat(h,"() reply due to destroyed connection"));return}var _={penpal:Rt,id:v,resolution:m,returnValue:b};m===Ot&&b instanceof Error&&(_.returnValue=nn(b),_.returnValueIsError=!0);try{c.postMessage(_,f)}catch(w){throw w.name===jn&&c.postMessage({penpal:Rt,id:v,resolution:Ot,returnValue:nn(w),returnValueIsError:!0},f),w}}};new $.Promise(function(y){return y(r[h].apply(r,p))}).then(g(rn),g(Ot))}}};o.addEventListener(D,s),n.then(function(){u=!0,o.removeEventListener(D,s)})};$.connectToChild=function(e){var t=e.url,r=e.appendTo,n=e.methods,i=n===void 0?{}:n,o=e.timeout,c,f=new Mt(function(h){c=h}),u=window,s=document.createElement("iframe");(r||document.body).appendChild(s),f.then(function(){s.parentNode&&s.parentNode.removeChild(s)});var a=s.contentWindow||s.contentDocument.parentWindow,l=Xn(t),d=new $.Promise(function(h,p){var v;o!==void 0&&(v=setTimeout(function(){var _=new Error("Connection to child timed out after ".concat(o,"ms"));_.code=ue,p(_),c()},o));var g={},y,m,b=function(w){if(w.source===a&&w.origin===l&&w.data.penpal===Qr){x("Parent: Received handshake, sending reply"),w.source.postMessage({penpal:en,methodNames:Object.keys(i)},w.origin);var T={localName:"Parent",local:u,remote:a,remoteOrigin:w.origin};m&&m();var S=new Mt(function(P){f.then(P),m=P});on(T,i,S),y&&y.forEach(function(P){delete g[P]}),y=w.data.methodNames,an(g,T,y,f),clearTimeout(v),h(g)}};u.addEventListener(D,b),f.then(function(){u.removeEventListener(D,b);var _=new Error("Connection destroyed");_.code=te,p(_)}),x("Parent: Loading iframe"),s.src=t});return{promise:d,iframe:s,destroy:c}};$.connectToParent=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.parentOrigin,r=t===void 0?"*":t,n=e.methods,i=n===void 0?{}:n,o=e.timeout;if(window===window.top){var c=new Error("connectToParent() must be called within an iframe");throw c.code=Lt,c}var f,u=new Mt(function(d){f=d}),s=window,a=s.parent,l=new $.Promise(function(d,h){var p;o!==void 0&&(p=setTimeout(function(){var g=new Error("Connection to parent timed out after ".concat(o,"ms"));g.code=ue,h(g),f()},o));var v=function g(y){if((r==="*"||r===y.origin)&&y.source===a&&y.data.penpal===en){x("Child: Received handshake reply"),s.removeEventListener(D,g);var m={localName:"Child",local:s,remote:a,remoteOrigin:y.origin},b={};on(m,i,u),an(b,m,y.data.methodNames,u),clearTimeout(p),d(b)}};s.addEventListener(D,v),u.then(function(){s.removeEventListener(D,v);var g=new Error("Connection destroyed");g.code=te,h(g)}),x("Child: Sending handshake"),a.postMessage({penpal:Qr,methodNames:Object.keys(i)},r)});return{promise:l,destroy:f}};var ei=$;Xr=G.default=ei;var ti=`
.por_portis-container {
  position: fixed;
  width: 0px;
  height: 0px;
  top: 0px;
  right: 0px;
  z-index: 2147483647;
}

@media (max-width: 576px) {
  .por_portis-container {
    bottom: 0;
    top: auto;
  }
}

.por_portis-widget-frame {
  position: fixed;
  width: 375px;
  height: 0;
  top: 20px;
  right: 20px;
  box-shadow: 0 5px 40px rgba(0,0,0,.16);
  border-radius: 8px;
  overflow: hidden;
  z-index: 2147483000;
}

@media (max-width: 576px) {
  .por_portis-widget-frame {
    bottom: 0;
    top: auto;
    width: 100%;
    right: 0;
    left: 0;
    border-bottom-left-radius: 0;
    border-bottom-right-radius: 0;
  }
}
`,A=globalThis&&globalThis.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function c(s){try{u(n.next(s))}catch(a){o(a)}}function f(s){try{u(n.throw(s))}catch(a){o(a)}}function u(s){s.done?i(s.value):new r(function(a){a(s.value)}).then(c,f)}u((n=n.apply(e,t||[])).next())})},R=globalThis&&globalThis.__generator||function(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,c;return c={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function f(s){return function(a){return u([s,a])}}function u(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=s[0]&2?i.return:s[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,s[1])).done)return o;switch(i=0,o&&(s=[s[0]&2,o.value]),s[0]){case 0:case 1:o=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,i=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!o||s[1]>o[0]&&s[1]<o[3])){r.label=s[1];break}if(s[0]===6&&r.label<o[1]){r.label=o[1],o=s;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(s);break}o[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(a){s=[6,a],i=0}finally{n=o=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},ri="https://widget.portis.io",ni="https://widget-staging.portis.io",sn="por_portis-widget-frame",cn="por_portis-container";function ii(){document.getElementsByClassName(sn).length&&console.warn("Portis script was already loaded. This might cause unexpected behavior. If loading with a <script> tag, please make sure that you only load it once.")}var ai=function(){function e(t,r){this._widgetConfig=t,this._clearProviderSession=r,this._widgetUrl=ri,this._onLoginCallback=function(){},this._onLogoutCallback=function(){},this._onActiveWalletChangedCallback=function(){},this._onErrorCallback=function(){},Yr(),t.staging&&(console.warn("Please note: you are using the Portis STAGING environment."),this._widgetUrl=ni),e._checkIfWidgetAlreadyInitialized()}return e.prototype.getWidget=function(){return A(this,void 0,void 0,function(){var t;return R(this,function(r){switch(r.label){case 0:return this.widgetInstance?[3,2]:(this.widgetPromise||(this.widgetPromise=this._initWidget()),t=this,[4,this.widgetPromise]);case 1:t.widgetInstance=r.sent(),r.label=2;case 2:return[2,this.widgetInstance]}})})},e.prototype.setDefaultEmail=function(t){this._widgetConfig.defaultEmail=t},e.prototype.setOnLoginCallback=function(t){this._onLoginCallback=t},e.prototype.setOnLogoutCallback=function(t){this._onLogoutCallback=t},e.prototype.setOnActiveWalletChangedCallback=function(t){this._onActiveWalletChangedCallback=t},e.prototype.setOnErrorCallback=function(t){this._onErrorCallback=t},e.prototype.showPortis=function(){return A(this,void 0,void 0,function(){var t;return R(this,function(r){switch(r.label){case 0:return[4,this.getWidget()];case 1:return t=r.sent().communication,[2,t.showPortis(this._widgetConfig)]}})})},e.prototype.getCampaignInfo=function(t){return A(this,void 0,void 0,function(){var r;return R(this,function(n){switch(n.label){case 0:return[4,this.getWidget()];case 1:return r=n.sent().communication,[2,r.getCampaignInfo(t)]}})})},e.prototype.claimVoucher=function(t){return A(this,void 0,void 0,function(){var r;return R(this,function(n){switch(n.label){case 0:return[4,this.getWidget()];case 1:return r=n.sent().communication,[2,r.claimVoucher(t,this._widgetConfig)]}})})},e.prototype.logout=function(){return A(this,void 0,void 0,function(){var t;return R(this,function(r){switch(r.label){case 0:return[4,this.getWidget()];case 1:return t=r.sent().communication,[2,t.logout()]}})})},e.prototype.getExtendedPublicKey=function(t,r){return t===void 0&&(t="m/44'/60'/0'/0/0"),r===void 0&&(r="Ethereum"),A(this,void 0,void 0,function(){var n;return R(this,function(i){switch(i.label){case 0:return[4,this.getWidget()];case 1:return n=i.sent().communication,[2,n.getExtendedPublicKey(t,r,this._widgetConfig)]}})})},e.prototype.importWallet=function(t){return A(this,void 0,void 0,function(){var r;return R(this,function(n){switch(n.label){case 0:return[4,this.getWidget()];case 1:return r=n.sent().communication,[2,r.importWallet(t,this._widgetConfig)]}})})},e.prototype.isLoggedIn=function(){return A(this,void 0,void 0,function(){var t;return R(this,function(r){switch(r.label){case 0:return[4,this.getWidget()];case 1:return t=r.sent().communication,[2,t.isLoggedIn()]}})})},e.prototype.signBitcoinTransaction=function(t){return A(this,void 0,void 0,function(){var r;return R(this,function(n){switch(n.label){case 0:return[4,this.getWidget()];case 1:return r=n.sent().communication,[2,r.signBitcoinTransaction(t,this._widgetConfig)]}})})},e.prototype.showBitcoinWallet=function(t){return t===void 0&&(t="m/49'/0'/0'/0/0"),A(this,void 0,void 0,function(){var r;return R(this,function(n){switch(n.label){case 0:return[4,this.getWidget()];case 1:return r=n.sent().communication,[2,r.showBitcoinWallet(t,this._widgetConfig)]}})})},e.prototype.purchaseERC20=function(t){return A(this,void 0,void 0,function(){var r;return R(this,function(n){switch(n.label){case 0:return[4,this.getWidget()];case 1:return r=n.sent().communication,[2,r.purchaseERC20(t,this._widgetConfig)]}})})},e._checkIfWidgetAlreadyInitialized=function(){document.getElementsByClassName(cn).length&&console.warn("An instance of Portis was already initialized. This is probably a mistake. Make sure that you use the same Portis instance throughout your app.")},e.prototype._initWidget=function(){return A(this,void 0,void 0,function(){var t,r,n,i,o;return R(this,function(c){switch(c.label){case 0:return[4,Jr()];case 1:return c.sent(),t=document.createElement("style"),t.innerHTML=ti,r=document.createElement("div"),r.className=cn,n=document.createElement("div"),n.id="portis-container-"+Date.now(),n.className=sn,r.appendChild(n),document.body.appendChild(r),document.head.appendChild(t),i=Xr.connectToChild({url:this._widgetUrl,appendTo:document.getElementById(n.id),methods:{setHeight:this._setHeight.bind(this),getWindowSize:e._getWindowSize.bind(this),onLogin:this._onLogin.bind(this),onLogout:this._onLogout.bind(this),onActiveWalletChanged:this._onActiveWalletChanged.bind(this),onError:this._onError.bind(this)}}),[4,i.promise];case 2:return o=c.sent(),o.setSdkConfig(this._widgetConfig),i.iframe.style.position="absolute",i.iframe.style.height="100%",i.iframe.style.width="100%",i.iframe.style.border="0 transparent",[2,{communication:o,widgetFrame:n}]}})})},e.prototype._setHeight=function(t){return A(this,void 0,void 0,function(){var r;return R(this,function(n){switch(n.label){case 0:return[4,this.getWidget()];case 1:return r=n.sent().widgetFrame,r.style.height=t+"px",[2]}})})},e._getWindowSize=function(){var t=document.getElementsByTagName("body")[0],r=window.innerWidth||document.documentElement.clientWidth||t.clientWidth,n=window.innerHeight||document.documentElement.clientHeight||t.clientHeight;return{width:r,height:n}},e.prototype._onLogin=function(t,r,n){this._onLoginCallback&&this._onLoginCallback(t,r,n)},e.prototype._onLogout=function(){this._clearProviderSession(),this._onLogoutCallback&&this._onLogoutCallback()},e.prototype._onActiveWalletChanged=function(t){this._onActiveWalletChangedCallback&&this._onActiveWalletChangedCallback(t)},e.prototype._onError=function(t){this._onErrorCallback&&this._onErrorCallback(t)},e}(),xt={exports:{}},Bt={exports:{}},fe={exports:{}},le={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={},e.exports=t.default})(le,le.exports);var It={exports:{}},de={exports:{}},re={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(n){return function(){if(n!==null){var i=n;n=null,i.apply(this,arguments)}}}e.exports=t.default})(re,re.exports);var Nt={exports:{}},Gt={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(n){return r&&n[r]&&n[r]()};var r=typeof Symbol=="function"&&Symbol.iterator;e.exports=t.default})(Gt,Gt.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=d;var r=Ct,n=u(r),i=Gt.exports,o=u(i),c=zn,f=u(c);function u(h){return h&&h.__esModule?h:{default:h}}function s(h){var p=-1,v=h.length;return function(){return++p<v?{value:h[p],key:p}:null}}function a(h){var p=-1;return function(){var g=h.next();return g.done?null:(p++,{value:g.value,key:p})}}function l(h){var p=(0,f.default)(h),v=-1,g=p.length;return function(){var m=p[++v];return v<g?{value:h[m],key:m}:null}}function d(h){if((0,n.default)(h))return s(h);var p=(0,o.default)(h);return p?a(p):l(h)}e.exports=t.default})(Nt,Nt.exports);var ne={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(n){return function(){if(n===null)throw new Error("Callback was already called.");var i=n;n=null,i.apply(this,arguments)}}e.exports=t.default})(ne,ne.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=h;var r=ee,n=d(r),i=re.exports,o=d(i),c=Nt.exports,f=d(c),u=ne.exports,s=d(u),a=le.exports,l=d(a);function d(p){return p&&p.__esModule?p:{default:p}}function h(p){return function(v,g,y){if(y=(0,o.default)(y||n.default),p<=0||!v)return y(null);var m=(0,f.default)(v),b=!1,_=0,w=!1;function T(P,H){if(_-=1,P)b=!0,y(P);else{if(H===l.default||b&&_<=0)return b=!0,y(null);w||S()}}function S(){for(w=!0;_<p&&!b;){var P=m();if(P===null){b=!0,_<=0&&y(null);return}_+=1,g(P.value,P.key,(0,s.default)(T))}w=!1}S()}}e.exports=t.default})(de,de.exports);var B={},Dt={exports:{}},Wt={exports:{}},q={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(n,i){i=i|0;for(var o=Math.max(n.length-i,0),c=Array(o),f=0;f<o;f++)c[f]=n[i+f];return c}e.exports=t.default})(q,q.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(o){return function(){var c=(0,n.default)(arguments),f=c.pop();o.call(this,c,f)}};var r=q.exports,n=i(r);function i(o){return o&&o.__esModule?o:{default:o}}e.exports=t.default})(Wt,Wt.exports);var W={};Object.defineProperty(W,"__esModule",{value:!0});W.hasNextTick=W.hasSetImmediate=void 0;W.fallback=un;W.wrap=fn;var oi=q.exports,si=ci(oi);function ci(e){return e&&e.__esModule?e:{default:e}}var ui=W.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,fi=W.hasNextTick=typeof process=="object"&&typeof process.nextTick=="function";function un(e){setTimeout(e,0)}function fn(e){return function(t){var r=(0,si.default)(arguments,1);e(function(){t.apply(null,r)})}}var he;ui?he=setImmediate:fi?he=process.nextTick:he=un;W.default=fn(he);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var r=qn,n=u(r),i=Wt.exports,o=u(i),c=W,f=u(c);function u(d){return d&&d.__esModule?d:{default:d}}function s(d){return(0,o.default)(function(h,p){var v;try{v=d.apply(this,h)}catch(g){return p(g)}(0,n.default)(v)&&typeof v.then=="function"?v.then(function(g){a(p,null,g)},function(g){a(p,g.message?g:new Error(g))}):p(null,v)})}function a(d,h,p){try{d(h,p)}catch(v){(0,f.default)(l,v)}}function l(d){throw d}e.exports=t.default})(Dt,Dt.exports);Object.defineProperty(B,"__esModule",{value:!0});B.isAsync=void 0;var li=Dt.exports,di=hi(li);function hi(e){return e&&e.__esModule?e:{default:e}}var pi=typeof Symbol=="function";function ln(e){return pi&&e[Symbol.toStringTag]==="AsyncFunction"}function vi(e){return ln(e)?(0,di.default)(e):e}B.default=vi;B.isAsync=ln;(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=f;var r=de.exports,n=c(r),i=B,o=c(i);function c(u){return u&&u.__esModule?u:{default:u}}function f(u,s,a,l){(0,n.default)(s)(u,(0,o.default)(a),l)}e.exports=t.default})(It,It.exports);var pe={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(n,i){return function(o,c,f){return n(o,i,c,f)}}e.exports=t.default})(pe,pe.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(w,T,S){var P=(0,n.default)(w)?b:_;P(w,(0,y.default)(T),S)};var r=Ct,n=m(r),i=le.exports,o=m(i),c=It.exports,f=m(c),u=pe.exports,s=m(u),a=ee,l=m(a),d=re.exports,h=m(d),p=ne.exports,v=m(p),g=B,y=m(g);function m(w){return w&&w.__esModule?w:{default:w}}function b(w,T,S){S=(0,h.default)(S||l.default);var P=0,H=0,z=w.length;z===0&&S(null);function ae(X,oe){X?S(X):(++H===z||oe===o.default)&&S(null)}for(;P<z;P++)T(w[P],P,(0,v.default)(ae))}var _=(0,s.default)(f.default,1/0);e.exports=t.default})(fe,fe.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=f;var r=fe.exports,n=c(r),i=B,o=c(i);function c(u){return u&&u.__esModule?u:{default:u}}function f(u){return function(s,a,l){return u(n.default,s,(0,o.default)(a),l)}}e.exports=t.default})(Bt,Bt.exports);var $t={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=f;var r=ee,n=c(r),i=B,o=c(i);function c(u){return u&&u.__esModule?u:{default:u}}function f(u,s,a,l){l=l||n.default,s=s||[];var d=[],h=0,p=(0,o.default)(a);u(s,function(v,g,y){var m=h++;p(v,function(b,_){d[m]=_,y(b)})},function(v){l(v,d)})}e.exports=t.default})($t,$t.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Bt.exports,n=c(r),i=$t.exports,o=c(i);function c(f){return f&&f.__esModule?f:{default:f}}t.default=(0,n.default)(o.default),e.exports=t.default})(xt,xt.exports);var Ft={exports:{}},Ut={exports:{}},Ht={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(n){return function(i,o,c){return n(i,c)}}e.exports=t.default})(Ht,Ht.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var r=de.exports,n=u(r),i=Ht.exports,o=u(i),c=B,f=u(c);function u(a){return a&&a.__esModule?a:{default:a}}function s(a,l,d,h){(0,n.default)(l)(a,(0,o.default)((0,f.default)(d)),h)}e.exports=t.default})(Ut,Ut.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Ut.exports,n=c(r),i=pe.exports,o=c(i);function c(f){return f&&f.__esModule?f:{default:f}}t.default=(0,o.default)(n.default,1),e.exports=t.default})(Ft,Ft.exports);const dn=qr.exports.EventEmitter,gi=Q.inherits;var mi=ie;gi(ie,dn);function ie(){const e=this;dn.call(e),e.isLocked=!0}ie.prototype.go=function(){const e=this;e.isLocked=!1,e.emit("unlock")};ie.prototype.stop=function(){const e=this;e.isLocked=!0,e.emit("lock")};ie.prototype.await=function(e){const t=this;t.isLocked?t.once("unlock",e):setTimeout(e)};var ve=typeof JSON!="undefined"?JSON:Gn,hn=function(e,t){t||(t={}),typeof t=="function"&&(t={cmp:t});var r=t.space||"";typeof r=="number"&&(r=Array(r+1).join(" "));var n=typeof t.cycles=="boolean"?t.cycles:!1,i=t.replacer||function(f,u){return u},o=t.cmp&&function(f){return function(u){return function(s,a){var l={key:s,value:u[s]},d={key:a,value:u[a]};return f(l,d)}}}(t.cmp),c=[];return function f(u,s,a,l){var d=r?`
`+new Array(l+1).join(r):"",h=r?": ":":";if(a&&a.toJSON&&typeof a.toJSON=="function"&&(a=a.toJSON()),a=i.call(u,s,a),a!==void 0){if(typeof a!="object"||a===null)return ve.stringify(a);if(yi(a)){for(var p=[],v=0;v<a.length;v++){var g=f(a,v,a[v],l+1)||ve.stringify(null);p.push(d+r+g)}return"["+p.join(",")+d+"]"}else{if(c.indexOf(a)!==-1){if(n)return ve.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}else c.push(a);for(var y=_i(a).sort(o&&o(a)),p=[],v=0;v<y.length;v++){var s=y[v],m=f(a,s,a[s],l+1);if(!!m){var b=ve.stringify(s)+h+m;p.push(d+r+b)}}return c.splice(c.indexOf(a),1),"{"+p.join(",")+d+"}"}}}({"":e},"",e,0)},yi=Array.isArray||function(e){return{}.toString.call(e)==="[object Array]"},_i=Object.keys||function(e){var t=Object.prototype.hasOwnProperty||function(){return!0},r=[];for(var n in e)t.call(e,n)&&r.push(n);return r},wi=bi;function bi(){return Math.floor(Number.MAX_SAFE_INTEGER*Math.random())}const ki=wi,Pi=Et;var Ti=Si;function Si(e){return Pi({id:ki(),jsonrpc:"2.0",params:[]},e)}const pn=qr.exports.EventEmitter,Ei=Q.inherits,E=ce,Ci=xn,Ai=xt.exports,Ri=Ft.exports,Oi=mi,Li=Ti,Mi=function(){};var xi=O;Ei(O,pn);function O(e){const t=this;pn.call(t),t.setMaxListeners(30),e=e||{};const r={sendAsync:t._handleAsync.bind(t)},n=e.blockTrackerProvider||r;t._blockTracker=e.blockTracker||new Ci({provider:n,pollingInterval:e.pollingInterval||4e3,setSkipCacheFlag:!0}),t._ready=new Oi,t.currentBlock=null,t._providers=[]}O.prototype.start=function(e=Mi){const t=this;t._ready.go(),t._blockTracker.on("latest",r=>{t._getBlockByNumberWithRetry(r,(n,i)=>{if(n){this.emit("error",n);return}if(!i){console.log(i),this.emit("error",new Error("Could not find block"));return}const o=Bi(i);t._setCurrentBlock(o),t.emit("rawBlock",i),t.emit("latest",i)})}),t._blockTracker.on("sync",t.emit.bind(t,"sync")),t._blockTracker.on("error",t.emit.bind(t,"error")),t._running=!0,t.emit("start")};O.prototype.stop=function(){const e=this;e._blockTracker.removeAllListeners(),e._running=!1,e.emit("stop")};O.prototype.isRunning=function(){return this._running};O.prototype.addProvider=function(e,t){const r=this;typeof t=="number"?r._providers.splice(t,0,e):r._providers.push(e),e.setEngine(this)};O.prototype.removeProvider=function(e){const t=this,r=t._providers.indexOf(e);if(r<0)throw new Error("Provider not found.");t._providers.splice(r,1)};O.prototype.send=function(e){throw new Error("Web3ProviderEngine does not support synchronous requests.")};O.prototype.sendAsync=function(e,t){const r=this;r._ready.await(function(){Array.isArray(e)?Ai(e,r._handleAsync.bind(r),t):r._handleAsync(e,t)})};O.prototype._getBlockByNumberWithRetry=function(e,t){const r=this;let n=5;i();return;function i(){r._getBlockByNumber(e,o)}function o(c,f){if(c)return t(c);if(!f)if(n>0){n--,setTimeout(function(){i()},1e3);return}else{t(null,null);return}t(null,f)}};O.prototype._getBlockByNumber=function(e,t){const r=Li({method:"eth_getBlockByNumber",params:[e,!1],skipCache:!0});this._handleAsync(r,(n,i)=>n?t(n):t(null,i.result))};O.prototype._handleAsync=function(e,t){var r=this,n=-1,i=null,o=null,c=[];f();function f(s){if(n+=1,c.unshift(s),n>=r._providers.length)u(new Error('Request for method "'+e.method+'" not handled by any subprovider. Please check your subprovider configuration to ensure this method is handled.'));else try{var a=r._providers[n];a.handleRequest(e,f,u)}catch(l){u(l)}}function u(s,a){o=s,i=a,Ri(c,function(l,d){l?l(o,i,d):d()},function(){var l={id:e.id,jsonrpc:e.jsonrpc,result:i};o!=null?(l.error={message:o.stack||o.message||o,code:-32e3},t(o,l)):t(null,l)})}};O.prototype._setCurrentBlock=function(e){const t=this;t.currentBlock=e,t.emit("block",e)};function Bi(e){return{number:E.toBuffer(e.number),hash:E.toBuffer(e.hash),parentHash:E.toBuffer(e.parentHash),nonce:E.toBuffer(e.nonce),mixHash:E.toBuffer(e.mixHash),sha3Uncles:E.toBuffer(e.sha3Uncles),logsBloom:E.toBuffer(e.logsBloom),transactionsRoot:E.toBuffer(e.transactionsRoot),stateRoot:E.toBuffer(e.stateRoot),receiptsRoot:E.toBuffer(e.receiptRoot||e.receiptsRoot),miner:E.toBuffer(e.miner),difficulty:E.toBuffer(e.difficulty),totalDifficulty:E.toBuffer(e.totalDifficulty),size:E.toBuffer(e.size),extraData:E.toBuffer(e.extraData),gasLimit:E.toBuffer(e.gasLimit),gasUsed:E.toBuffer(e.gasUsed),timestamp:E.toBuffer(e.timestamp),transactions:e.transactions}}var Ii=Ni;function Ni(){return Math.floor(Number.MAX_SAFE_INTEGER*Math.random())}var Gi=Ii,Di=Et,vn=Wi;function Wi(e){return Di({id:Gi(),jsonrpc:"2.0",params:[]},e)}var $i=vn,ge=K;function K(){}K.prototype.setEngine=function(e){var t=this;t.engine||(t.engine=e,e.on("block",function(r){t.currentBlock=r}),e.on("start",function(){t.start()}),e.on("stop",function(){t.stop()}))};K.prototype.handleRequest=function(e,t,r){throw new Error("Subproviders should override `handleRequest`.")};K.prototype.emitPayload=function(e,t){var r=this;r.engine.sendAsync($i(e),t)};K.prototype.stop=function(){};K.prototype.start=function(){};function me(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?me=function(r){return typeof r}:me=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},me(e)}function Fi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ui(e,t,r){return t&&gn(e.prototype,t),r&&gn(e,r),e}function Hi(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zt(e,t)}function zt(e,t){return zt=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},zt(e,t)}function zi(e){return function(){var t=ye(e),r;if(Vi()){var n=ye(this).constructor;r=Reflect.construct(t,arguments,n)}else r=t.apply(this,arguments);return qi(this,r)}}function qi(e,t){return t&&(me(t)==="object"||typeof t=="function")?t:Ki(e)}function Ki(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vi(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function ye(e){return ye=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},ye(e)}var ji=ge,Zi=function(e){Hi(r,e);var t=zi(r);function r(n){var i;if(Fi(this,r),i=t.call(this),!n)throw new Error("JsonRpcEngineMiddlewareSubprovider - no constructorFn specified");return i._constructorFn=n,i}return Ui(r,[{key:"setEngine",value:function(i){if(this.middleware)throw new Error("JsonRpcEngineMiddlewareSubprovider - subprovider added to engine twice");var o=i._blockTracker,c=this._constructorFn({engine:i,provider:i,blockTracker:o});if(!c)throw new Error("JsonRpcEngineMiddlewareSubprovider - _constructorFn did not return middleware");if(typeof c!="function")throw new Error("JsonRpcEngineMiddlewareSubprovider - specified middleware is not a function");this.middleware=c}},{key:"handleRequest",value:function(i,o,c){var f={id:i.id};this.middleware(i,f,u,s);function u(a){o(function(l,d,h){l?(delete f.result,f.error={message:l.message||l}):f.result=d,a?a(h):h()})}function s(a){if(a)return c(a);c(null,f.result)}}}]),r}(ji),qt=Zi;const Ji=hn;var Yi={cacheIdentifierForPayload:Xi,canCache:mn,blockTagForPayload:Qi,paramsWithoutBlockTag:yn,blockTagParamIndex:Kt,cacheTypeForPayload:_n};function Xi(e,t){const r=t?yn(e):e.params;return mn(e)?e.method+":"+Ji(r):null}function mn(e){return _n(e)!=="never"}function Qi(e){let t=Kt(e);return t>=e.params.length?null:e.params[t]}function yn(e){const t=Kt(e);return t>=e.params.length?e.params:e.method==="eth_getBlockByNumber"?e.params.slice(1):e.params.slice(0,t)}function Kt(e){switch(e.method){case"eth_getStorageAt":return 2;case"eth_getBalance":case"eth_getCode":case"eth_getTransactionCount":case"eth_call":return 1;case"eth_getBlockByNumber":return 0;default:return}}function _n(e){switch(e.method){case"web3_clientVersion":case"web3_sha3":case"eth_protocolVersion":case"eth_getBlockTransactionCountByHash":case"eth_getUncleCountByBlockHash":case"eth_getCode":case"eth_getBlockByHash":case"eth_getTransactionByHash":case"eth_getTransactionByBlockHashAndIndex":case"eth_getTransactionReceipt":case"eth_getUncleByBlockHashAndIndex":case"eth_getCompilers":case"eth_compileLLL":case"eth_compileSolidity":case"eth_compileSerpent":case"shh_version":case"test_permaCache":return"perma";case"eth_getBlockByNumber":case"eth_getBlockTransactionCountByNumber":case"eth_getUncleCountByBlockNumber":case"eth_getTransactionByBlockNumberAndIndex":case"eth_getUncleByBlockNumberAndIndex":case"test_forkCache":return"fork";case"eth_gasPrice":case"eth_blockNumber":case"eth_getBalance":case"eth_getStorageAt":case"eth_getTransactionCount":case"eth_call":case"eth_estimateGas":case"eth_getFilterLogs":case"eth_getLogs":case"test_blockCache":return"block";case"net_version":case"net_peerCount":case"net_listening":case"eth_syncing":case"eth_sign":case"eth_coinbase":case"eth_mining":case"eth_hashrate":case"eth_accounts":case"eth_sendTransaction":case"eth_sendRawTransaction":case"eth_newFilter":case"eth_newBlockFilter":case"eth_newPendingTransactionFilter":case"eth_uninstallFilter":case"eth_getFilterChanges":case"eth_getWork":case"eth_submitWork":case"eth_submitHashrate":case"db_putString":case"db_getString":case"db_putHex":case"db_getHex":case"shh_post":case"shh_newIdentity":case"shh_hasIdentity":case"shh_newGroup":case"shh_addToGroup":case"shh_newFilter":case"shh_uninstallFilter":case"shh_getFilterChanges":case"shh_getMessages":case"test_neverCache":return"never"}}var ea=function(t){return(r,n,i,o)=>{let c;const f=new Promise(l=>{c=l});let u,s;t(r,n,async()=>{s=!0,i(l=>{u=l,c()}),await f}).then(async()=>{s?(await f,u(null)):o(null)}).catch(l=>{u?u(l):o(l)})}};const V=Yi,ta=ea,ra=[void 0,null,"<nil>"];var na=ia;function ia(e={}){const{blockTracker:t}=e;if(!t)throw new Error("createBlockCacheMiddleware - No BlockTracker specified");const r=new aa,n={perma:r,block:r,fork:r};return ta(async(i,o,c)=>{if(i.skipCache)return c();const f=V.cacheTypeForPayload(i),u=n[f];if(!u||!u.canCacheRequest(i))return c();let s=V.blockTagForPayload(i);s||(s="latest");let a;if(s==="earliest")a="0x00";else if(s==="latest"){const d=await t.getLatestBlock();r.clearBefore(d),a=d}else a=s;const l=await u.get(i,a);l===void 0?(await c(),await u.set(i,a,o.result)):o.result=l})}class aa{constructor(){this.cache={}}getBlockCacheForPayload(t,r){const n=Number.parseInt(r,16);let i=this.cache[n];if(!i){const o={};this.cache[n]=o,i=o}return i}async get(t,r){const n=this.getBlockCacheForPayload(t,r);if(!n)return;const i=V.cacheIdentifierForPayload(t,!0);return n[i]}async set(t,r,n){if(!this.canCacheResult(t,n))return;const o=this.getBlockCacheForPayload(t,r),c=V.cacheIdentifierForPayload(t,!0);o[c]=n}canCacheRequest(t){return!(!V.canCache(t)||V.blockTagForPayload(t)==="pending")}canCacheResult(t,r){if(!ra.includes(r))return!(["eth_getTransactionByHash","eth_getTransactionReceipt"].includes(t.method)&&(!r||!r.blockHash||r.blockHash==="0x0000000000000000000000000000000000000000000000000000000000000000"))}clearBefore(t){const r=this,n=Number.parseInt(t,16);Object.keys(r.cache).map(Number).filter(i=>i<n).forEach(i=>delete r.cache[i])}}function _e(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_e=function(r){return typeof r}:_e=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},_e(e)}function oa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sa(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vt(e,t)}function Vt(e,t){return Vt=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Vt(e,t)}function ca(e){return function(){var t=we(e),r;if(la()){var n=we(this).constructor;r=Reflect.construct(t,arguments,n)}else r=t.apply(this,arguments);return ua(this,r)}}function ua(e,t){return t&&(_e(t)==="object"||typeof t=="function")?t:fa(e)}function fa(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function la(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function we(e){return we=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},we(e)}var da=qt,ha=na,pa=function(e){sa(r,e);var t=ca(r);function r(n){return oa(this,r),t.call(this,function(i){var o=i.blockTracker;return ha(Object.assign({blockTracker:o},n))})}return r}(da),va=pa,ga=Q.inherits,ma=ge,ya=jt;ga(jt,ma);function jt(e){var t=this;e=e||{},t.staticResponses=e}jt.prototype.handleRequest=function(e,t,r){var n=this,i=n.staticResponses[e.method];typeof i=="function"?i(e,t,r):i!==void 0?setTimeout(function(){return r(null,i)}):t()};function be(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?be=function(r){return typeof r}:be=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},be(e)}function _a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wa(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zt(e,t)}function Zt(e,t){return Zt=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Zt(e,t)}function ba(e){return function(){var t=ke(e),r;if(Ta()){var n=ke(this).constructor;r=Reflect.construct(t,arguments,n)}else r=t.apply(this,arguments);return ka(this,r)}}function ka(e,t){return t&&(be(t)==="object"||typeof t=="function")?t:Pa(e)}function Pa(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ta(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function ke(e){return ke=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},ke(e)}var Sa=qt,Ea=Bn,Ca=function(e){wa(r,e);var t=ba(r);function r(){return _a(this,r),t.call(this,function(n){var i=n.blockTracker,o=n.provider;return n.engine,Ea({blockTracker:i,provider:o})})}return r}(Sa),Aa=Ca,Jt={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(v,g){if(g=(0,f.default)(g||o.default),!(0,n.default)(v))return g(new Error("First argument to waterfall must be an array of functions"));if(!v.length)return g();var y=0;function m(_){var w=(0,h.default)(v[y++]);_.push((0,l.default)(b)),w.apply(null,_)}function b(_){if(_||y===v.length)return g.apply(null,arguments);m((0,s.default)(arguments,1))}m([])};var r=Kn,n=p(r),i=ee,o=p(i),c=re.exports,f=p(c),u=q.exports,s=p(u),a=ne.exports,l=p(a),d=B,h=p(d);function p(v){return v&&v.__esModule?v:{default:v}}e.exports=t.default})(Jt,Jt.exports);var Yt={exports:{}},Xt={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=l;var r=ee,n=a(r),i=Ct,o=a(i),c=q.exports,f=a(c),u=B,s=a(u);function a(d){return d&&d.__esModule?d:{default:d}}function l(d,h,p){p=p||n.default;var v=(0,o.default)(h)?[]:{};d(h,function(g,y,m){(0,s.default)(g)(function(b,_){arguments.length>2&&(_=(0,f.default)(arguments,1)),v[y]=_,m(b)})},function(g){p(g,v)})}e.exports=t.default})(Xt,Xt.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=f;var r=fe.exports,n=c(r),i=Xt.exports,o=c(i);function c(u){return u&&u.__esModule?u:{default:u}}function f(u,s){(0,o.default)(n.default,u,s)}e.exports=t.default})(Yt,Yt.exports);var Ra=vn,Oa=La;function La(e,t,r){e.sendAsync(Ra({method:"eth_estimateGas",params:[t]}),function(n,i){if(n)return n.message==="no contract code at given address"?r(null,"0xcf08"):r(n);r(null,i.result)})}var C=Jt.exports,Ma=Yt.exports,xa=Q.inherits,Pe=ce,Ba=Dn,j=Et,Ia=Wn.exports,Na=ge,Ga=Oa,Da=/^[0-9A-Fa-f]+$/g,Wa=k;xa(k,Na);function k(e){var t=this;t.nonceLock=Ia(1),e.getAccounts&&(t.getAccounts=e.getAccounts),e.processTransaction&&(t.processTransaction=e.processTransaction),e.processMessage&&(t.processMessage=e.processMessage),e.processPersonalMessage&&(t.processPersonalMessage=e.processPersonalMessage),e.processTypedMessage&&(t.processTypedMessage=e.processTypedMessage),t.approveTransaction=e.approveTransaction||t.autoApprove,t.approveMessage=e.approveMessage||t.autoApprove,t.approvePersonalMessage=e.approvePersonalMessage||t.autoApprove,t.approveDecryptMessage=e.approveDecryptMessage||t.autoApprove,t.approveEncryptionPublicKey=e.approveEncryptionPublicKey||t.autoApprove,t.approveTypedMessage=e.approveTypedMessage||t.autoApprove,e.signTransaction&&(t.signTransaction=e.signTransaction||Z("signTransaction")),e.signMessage&&(t.signMessage=e.signMessage||Z("signMessage")),e.signPersonalMessage&&(t.signPersonalMessage=e.signPersonalMessage||Z("signPersonalMessage")),e.decryptMessage&&(t.decryptMessage=e.decryptMessage||Z("decryptMessage")),e.encryptionPublicKey&&(t.encryptionPublicKey=e.encryptionPublicKey||Z("encryptionPublicKey")),e.signTypedMessage&&(t.signTypedMessage=e.signTypedMessage||Z("signTypedMessage")),e.recoverPersonalSignature&&(t.recoverPersonalSignature=e.recoverPersonalSignature),e.publishTransaction&&(t.publishTransaction=e.publishTransaction),t.estimateGas=e.estimateGas||t.estimateGas,t.getGasPrice=e.getGasPrice||t.getGasPrice}k.prototype.handleRequest=function(e,t,r){var n=this;n._parityRequests={},n._parityRequestCount=0;var i,o,c,f,u;switch(e.method){case"eth_coinbase":n.getAccounts(function(s,a){if(s)return r(s);var l=a[0]||null;r(null,l)});return;case"eth_accounts":n.getAccounts(function(s,a){if(s)return r(s);r(null,a)});return;case"eth_sendTransaction":i=e.params[0],C([function(s){return n.validateTransaction(i,s)},function(s){return n.processTransaction(i,s)}],r);return;case"eth_signTransaction":i=e.params[0],C([function(s){return n.validateTransaction(i,s)},function(s){return n.processSignTransaction(i,s)}],r);return;case"eth_sign":u=e.params[0],f=e.params[1],c=e.params[2]||{},o=j(c,{from:u,data:f}),C([function(s){return n.validateMessage(o,s)},function(s){return n.processMessage(o,s)}],r);return;case"personal_sign":return function(){var s=e.params[0],a=e.params[1];if(wn(a)&&Qt(s)){var l="The eth_personalSign method requires params ordered ";l+="[message, address]. This was previously handled incorrectly, ",l+="and has been corrected automatically. ",l+="Please switch this param order for smooth behavior in the future.",console.warn(l),u=e.params[0],f=e.params[1]}else f=e.params[0],u=e.params[1];c=e.params[2]||{},o=j(c,{from:u,data:f}),C([function(d){return n.validatePersonalMessage(o,d)},function(d){return n.processPersonalMessage(o,d)}],r)}();case"eth_decryptMessage":return function(){var s=e.params[0],a=e.params[1];if(wn(a)&&Qt(s)){var l="The eth_decryptMessage method requires params ordered ";l+="[message, address]. This was previously handled incorrectly, ",l+="and has been corrected automatically. ",l+="Please switch this param order for smooth behavior in the future.",console.warn(l),u=e.params[0],f=e.params[1]}else f=e.params[0],u=e.params[1];c=e.params[2]||{},o=j(c,{from:u,data:f}),C([function(d){return n.validateDecryptMessage(o,d)},function(d){return n.processDecryptMessage(o,d)}],r)}();case"encryption_public_key":return function(){var s=e.params[0];C([function(a){return n.validateEncryptionPublicKey(s,a)},function(a){return n.processEncryptionPublicKey(s,a)}],r)}();case"personal_ecRecover":return function(){f=e.params[0];var s=e.params[1];c=e.params[2]||{},o=j(c,{sig:s,data:f}),n.recoverPersonalSignature(o,r)}();case"eth_signTypedData":case"eth_signTypedData_v3":case"eth_signTypedData_v4":return function(){var s=e.params[0],a=e.params[1];Qt(s)?(u=s,f=a):(f=s,u=a),c=e.params[2]||{},o=j(c,{from:u,data:f}),C([function(l){return n.validateTypedMessage(o,l)},function(l){return n.processTypedMessage(o,l)}],r)}();case"parity_postTransaction":i=e.params[0],n.parityPostTransaction(i,r);return;case"parity_postSign":u=e.params[0],f=e.params[1],n.parityPostSign(u,f,r);return;case"parity_checkRequest":return function(){var s=e.params[0];n.parityCheckRequest(s,r)}();case"parity_defaultAccount":n.getAccounts(function(s,a){if(s)return r(s);var l=a[0]||null;r(null,l)});return;default:t();return}};k.prototype.getAccounts=function(e){e(null,[])};k.prototype.processTransaction=function(e,t){var r=this;C([function(n){return r.approveTransaction(e,n)},function(n,i){return r.checkApproval("transaction",n,i)},function(n){return r.finalizeAndSubmitTx(e,n)}],t)};k.prototype.processSignTransaction=function(e,t){var r=this;C([function(n){return r.approveTransaction(e,n)},function(n,i){return r.checkApproval("transaction",n,i)},function(n){return r.finalizeTx(e,n)}],t)};k.prototype.processMessage=function(e,t){var r=this;C([function(n){return r.approveMessage(e,n)},function(n,i){return r.checkApproval("message",n,i)},function(n){return r.signMessage(e,n)}],t)};k.prototype.processPersonalMessage=function(e,t){var r=this;C([function(n){return r.approvePersonalMessage(e,n)},function(n,i){return r.checkApproval("message",n,i)},function(n){return r.signPersonalMessage(e,n)}],t)};k.prototype.processDecryptMessage=function(e,t){var r=this;C([function(n){return r.approveDecryptMessage(e,n)},function(n,i){return r.checkApproval("decryptMessage",n,i)},function(n){return r.decryptMessage(e,n)}],t)};k.prototype.processEncryptionPublicKey=function(e,t){var r=this;C([function(n){return r.approveEncryptionPublicKey(e,n)},function(n,i){return r.checkApproval("encryptionPublicKey",n,i)},function(n){return r.encryptionPublicKey(e,n)}],t)};k.prototype.processTypedMessage=function(e,t){var r=this;C([function(n){return r.approveTypedMessage(e,n)},function(n,i){return r.checkApproval("message",n,i)},function(n){return r.signTypedMessage(e,n)}],t)};k.prototype.autoApprove=function(e,t){t(null,!0)};k.prototype.checkApproval=function(e,t,r){r(t?null:new Error("User denied "+e+" signature."))};k.prototype.parityPostTransaction=function(e,t){var r=this,n=r._parityRequestCount,i="0x".concat(n.toString(16));r._parityRequestCount++,r.emitPayload({method:"eth_sendTransaction",params:[e]},function(o,c){if(o){r._parityRequests[i]={error:o};return}var f=c.result;r._parityRequests[i]=f}),t(null,i)};k.prototype.parityPostSign=function(e,t,r){var n=this,i=n._parityRequestCount,o="0x".concat(i.toString(16));n._parityRequestCount++,n.emitPayload({method:"eth_sign",params:[e,t]},function(c,f){if(c){n._parityRequests[o]={error:c};return}var u=f.result;n._parityRequests[o]=u}),r(null,o)};k.prototype.parityCheckRequest=function(e,t){var r=this,n=r._parityRequests[e]||null;if(!n)return t(null,null);if(n.error)return t(n.error);t(null,n)};k.prototype.recoverPersonalSignature=function(e,t){var r;try{r=Ba.recoverPersonalSignature(e)}catch(n){return t(n)}t(null,r)};k.prototype.validateTransaction=function(e,t){var r=this;if(e.from===void 0)return t(new Error("Undefined address - from address required to sign transaction."));r.validateSender(e.from,function(n,i){if(n)return t(n);if(!i)return t(new Error('Unknown address - unable to sign transaction for this address: "'.concat(e.from,'"')));t()})};k.prototype.validateMessage=function(e,t){var r=this;if(e.from===void 0)return t(new Error("Undefined address - from address required to sign message."));r.validateSender(e.from,function(n,i){if(n)return t(n);if(!i)return t(new Error('Unknown address - unable to sign message for this address: "'.concat(e.from,'"')));t()})};k.prototype.validatePersonalMessage=function(e,t){var r=this;if(e.from===void 0)return t(new Error("Undefined address - from address required to sign personal message."));if(e.data===void 0)return t(new Error("Undefined message - message required to sign personal message."));if(!er(e.data))return t(new Error("HookedWalletSubprovider - validateMessage - message was not encoded as hex."));r.validateSender(e.from,function(n,i){if(n)return t(n);if(!i)return t(new Error('Unknown address - unable to sign message for this address: "'.concat(e.from,'"')));t()})};k.prototype.validateDecryptMessage=function(e,t){var r=this;if(e.from===void 0)return t(new Error("Undefined address - from address required to decrypt message."));if(e.data===void 0)return t(new Error("Undefined message - message required to decrypt message."));if(!er(e.data))return t(new Error("HookedWalletSubprovider - validateDecryptMessage - message was not encoded as hex."));r.validateSender(e.from,function(n,i){if(n)return t(n);if(!i)return t(new Error('Unknown address - unable to decrypt message for this address: "'.concat(e.from,'"')));t()})};k.prototype.validateEncryptionPublicKey=function(e,t){var r=this;r.validateSender(e,function(n,i){if(n)return t(n);if(!i)return t(new Error('Unknown address - unable to obtain encryption public key for this address: "'.concat(e,'"')));t()})};k.prototype.validateTypedMessage=function(e,t){if(e.from===void 0)return t(new Error("Undefined address - from address required to sign typed data."));if(e.data===void 0)return t(new Error("Undefined data - message required to sign typed data."));this.validateSender(e.from,function(r,n){if(r)return t(r);if(!n)return t(new Error('Unknown address - unable to sign message for this address: "'.concat(e.from,'"')));t()})};k.prototype.validateSender=function(e,t){var r=this;if(!e)return t(null,!1);r.getAccounts(function(n,i){if(n)return t(n);var o=i.map(Fa).indexOf(e.toLowerCase())!==-1;t(null,o)})};k.prototype.finalizeAndSubmitTx=function(e,t){var r=this;r.nonceLock.take(function(){C([r.fillInTxExtras.bind(r,e),r.signTransaction.bind(r),r.publishTransaction.bind(r)],function(n,i){if(r.nonceLock.leave(),n)return t(n);t(null,i)})})};k.prototype.finalizeTx=function(e,t){var r=this;r.nonceLock.take(function(){C([r.fillInTxExtras.bind(r,e),r.signTransaction.bind(r)],function(n,i){if(r.nonceLock.leave(),n)return t(n);t(null,{raw:i,tx:e})})})};k.prototype.publishTransaction=function(e,t){var r=this;r.emitPayload({method:"eth_sendRawTransaction",params:[e]},function(n,i){if(n)return t(n);t(null,i.result)})};k.prototype.estimateGas=function(e,t){var r=this;Ga(r.engine,e,t)};k.prototype.getGasPrice=function(e){var t=this;t.emitPayload({method:"eth_gasPrice",params:[]},function(r,n){if(r)return e(r);e(null,n.result)})};k.prototype.fillInTxExtras=function(e,t){var r=this,n=e.from,i={};e.gasPrice===void 0&&(i.gasPrice=r.getGasPrice.bind(r)),e.nonce===void 0&&(i.nonce=r.emitPayload.bind(r,{method:"eth_getTransactionCount",params:[n,"pending"]})),e.gas===void 0&&(i.gas=r.estimateGas.bind(r,$a(e))),Ma(i,function(o,c){if(o)return t(o);var f={};c.gasPrice&&(f.gasPrice=c.gasPrice),c.nonce&&(f.nonce=c.nonce.result),c.gas&&(f.gas=c.gas),t(null,j(e,f))})};function $a(e){return{from:e.from,to:e.to,value:e.value,data:e.data,gas:e.gas,gasPrice:e.gasPrice,nonce:e.nonce}}function Fa(e){return e.toLowerCase()}function Qt(e){var t=Pe.addHexPrefix(e),r=Pe.isValidAddress(t);return r}function wn(e){var t=Pe.addHexPrefix(e),r=Pe.isValidAddress(t);return!r&&er(e)}function er(e){var t=typeof e=="string";if(!t)return!1;var r=e.slice(0,2)==="0x";if(!r)return!1;var n=e.slice(2),i=n.match(Da);return i}function Z(e){return function(t,r){r(new Error('ProviderEngine - HookedWalletSubprovider - Must provide "'+e+'" fn in constructor options'))}}const Ua={v:5e3,d:"Gas limit of the Genesis block."},Ha={v:17179869184,d:"Difficulty of the Genesis block."},za={v:"0x0000000000000042",d:"the geneis nonce"},qa={v:"0x11bbe8db4e347b4e8c937c1c8370e4b5ed33adb3db69cbdb7a38e1e50b1b82fa",d:"extra data "},Ka={v:"0xd4e56740f876aef8c010b86a40d5f56745a118d0906a34e69aec8c0db1cb8fa3",d:"genesis hash"},Va={v:"0xd7f8974fb5ac78d9ac099b9ad5018bedc2ce0a72dad1827a1709da30580f0544",d:"the genesis state root"},ja={v:5e3,d:"Minimum the gas limit may ever be."},Za={v:1024,d:"The bound divisor of the gas limit, used in update calculations."},Ja={v:131072,d:"The minimum that the difficulty may ever be."},Ya={v:2048,d:"The bound divisor of the difficulty, used in the update calculations."},Xa={v:13,d:"The decision boundary on the blocktime duration used to determine whether difficulty should go up or not."},Qa={v:32,d:"Maximum size extra data may be after Genesis."},eo={v:3e4,d:"Duration between proof-of-work epochs."},to={v:1024,d:"Maximum size of VM stack allowed."},ro={v:1024,d:"Maximum depth of call/create stack."},no={v:[0,2,3,5,8,10,20],d:"Once per operation, for a selection of them."},io={v:10,d:"Once per EXP instuction."},ao={v:10,d:"Times ceil(log256(exponent)) for the EXP instruction."},oo={v:30,d:"Once per SHA3 operation."},so={v:6,d:"Once per word of the SHA3 operation's data."},co={v:50,d:"Once per SLOAD operation."},uo={v:2e4,d:"Once per SSTORE operation if the zeroness changes from zero."},fo={v:5e3,d:"Once per SSTORE operation if the zeroness does not change from zero."},lo={v:15e3,d:"Once per SSTORE operation if the zeroness changes to zero."},ho={v:1,d:"Refunded gas, once per SSTORE operation if the zeroness changes to zero."},po={v:375,d:"Per LOG* operation."},vo={v:8,d:"Per byte in a LOG* operation's data."},go={v:375,d:"Multiplied by the * of the LOG*, per LOG transaction. e.g. LOG0 incurs 0 * c_txLogTopicGas, LOG4 incurs 4 * c_txLogTopicGas."},mo={v:32e3,d:"Once per CREATE operation & contract-creation transaction."},yo={v:40,d:"Once per CALL operation & message call transaction."},_o={v:2300,d:"Free gas given at beginning of call."},wo={v:9e3,d:"Paid for CALL when the value transfor is non-zero."},bo={v:25e3,d:"Paid for CALL when the destination address didn't exist prior."},ko={v:24e3,d:"Refunded following a suicide operation."},Po={v:3,d:"Times the address of the (highest referenced byte in memory + 1). NOTE: referencing happens on read, write and in instructions such as RETURN and CALL."},To={v:512,d:"Divisor for the quadratic particle of the memory cost equation."},So={v:200,d:""},Eo={v:21e3,d:"Per transaction. NOTE: Not payable on data of calls between transactions."},Co={v:32e3,d:"the cost of creating a contract via tx"},Ao={v:4,d:"Per byte of data attached to a transaction that equals zero. NOTE: Not payable on data of calls between transactions."},Ro={v:68,d:"Per byte of data attached to a transaction that is not equal to zero. NOTE: Not payable on data of calls between transactions."},Oo={v:3,d:"Multiplied by the number of 32-byte words that are copied (round up) for any *COPY operation and added."},Lo={v:3e3,d:""},Mo={v:60,d:""},xo={v:12,d:""},Bo={v:600,d:""},Io={v:120,d:""},No={v:15,d:""},Go={v:3,d:""},Do={v:"5000000000000000000",d:"the amount a miner get rewarded for mining a block"},Wo={v:"625000000000000000",d:"The amount of wei a miner of an uncle block gets for being inculded in the blockchain"},$o={v:"156250000000000000",d:"the amount a miner gets for inculding a uncle"},Fo={v:115e4,d:"the block that the Homestead fork started at"},Uo={v:2463e3,d:"the block that the Homestead Reprice (EIP150) fork started at"},Ho={v:1e5,d:"Exponential difficulty timebomb period"},zo={v:2};var qo={genesisGasLimit:Ua,genesisDifficulty:Ha,genesisNonce:za,genesisExtraData:qa,genesisHash:Ka,genesisStateRoot:Va,minGasLimit:ja,gasLimitBoundDivisor:Za,minimumDifficulty:Ja,difficultyBoundDivisor:Ya,durationLimit:Xa,maximumExtraDataSize:Qa,epochDuration:eo,stackLimit:to,callCreateDepth:ro,tierStepGas:no,expGas:io,expByteGas:ao,sha3Gas:oo,sha3WordGas:so,sloadGas:co,sstoreSetGas:uo,sstoreResetGas:fo,sstoreRefundGas:lo,jumpdestGas:ho,logGas:po,logDataGas:vo,logTopicGas:go,createGas:mo,callGas:yo,callStipend:_o,callValueTransferGas:wo,callNewAccountGas:bo,suicideRefundGas:ko,memoryGas:Po,quadCoeffDiv:To,createDataGas:So,txGas:Eo,txCreation:Co,txDataZeroGas:Ao,txDataNonZeroGas:Ro,copyGas:Oo,ecrecoverGas:Lo,sha256Gas:Mo,sha256WordGas:xo,ripemd160Gas:Bo,ripemd160WordGas:Io,identityGas:No,identityWordGas:Go,minerReward:Do,ommerReward:Wo,niblingReward:$o,homeSteadForkNumber:Fo,homesteadRepriceForkNumber:Uo,timebombPeriod:Ho,freeBlockPeriod:zo};function Ko(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var F=ce,Te=qo,U=F.BN,Vo=new U("7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a0",16),jo=function(){function e(t){Ko(this,e),t=t||{};var r=[{name:"nonce",length:32,allowLess:!0,default:new Buffer([])},{name:"gasPrice",length:32,allowLess:!0,default:new Buffer([])},{name:"gasLimit",alias:"gas",length:32,allowLess:!0,default:new Buffer([])},{name:"to",allowZero:!0,length:20,default:new Buffer([])},{name:"value",length:32,allowLess:!0,default:new Buffer([])},{name:"data",alias:"input",allowZero:!0,default:new Buffer([])},{name:"v",allowZero:!0,default:new Buffer([28])},{name:"r",length:32,allowZero:!0,allowLess:!0,default:new Buffer([])},{name:"s",length:32,allowZero:!0,allowLess:!0,default:new Buffer([])}];F.defineProperties(this,r,t),Object.defineProperty(this,"from",{enumerable:!0,configurable:!0,get:this.getSenderAddress.bind(this)});var n=F.bufferToInt(this.v),i=Math.floor((n-35)/2);i<0&&(i=0),this._chainId=i||t.chainId||0,this._homestead=!0}return e.prototype.toCreationAddress=function(){return this.to.toString("hex")===""},e.prototype.hash=function(r){r===void 0&&(r=!0);var n=void 0;if(r)n=this.raw;else if(this._chainId>0){var i=this.raw.slice();this.v=this._chainId,this.r=0,this.s=0,n=this.raw,this.raw=i}else n=this.raw.slice(0,6);return F.rlphash(n)},e.prototype.getChainId=function(){return this._chainId},e.prototype.getSenderAddress=function(){if(this._from)return this._from;var r=this.getSenderPublicKey();return this._from=F.publicToAddress(r),this._from},e.prototype.getSenderPublicKey=function(){if((!this._senderPubKey||!this._senderPubKey.length)&&!this.verifySignature())throw new Error("Invalid Signature");return this._senderPubKey},e.prototype.verifySignature=function(){var r=this.hash(!1);if(this._homestead&&new U(this.s).cmp(Vo)===1)return!1;try{var n=F.bufferToInt(this.v);this._chainId>0&&(n-=this._chainId*2+8),this._senderPubKey=F.ecrecover(r,n,this.r,this.s)}catch{return!1}return!!this._senderPubKey},e.prototype.sign=function(r){var n=this.hash(!1),i=F.ecsign(n,r);this._chainId>0&&(i.v+=this._chainId*2+8),Object.assign(this,i)},e.prototype.getDataFee=function(){for(var r=this.raw[5],n=new U(0),i=0;i<r.length;i++)r[i]===0?n.iaddn(Te.txDataZeroGas.v):n.iaddn(Te.txDataNonZeroGas.v);return n},e.prototype.getBaseFee=function(){var r=this.getDataFee().iaddn(Te.txGas.v);return this._homestead&&this.toCreationAddress()&&r.iaddn(Te.txCreation.v),r},e.prototype.getUpfrontCost=function(){return new U(this.gasLimit).imul(new U(this.gasPrice)).iadd(new U(this.value))},e.prototype.validate=function(r){var n=[];return this.verifySignature()||n.push("Invalid Signature"),this.getBaseFee().cmp(new U(this.gasLimit))>0&&n.push(["gas limit is too low. Need at least "+this.getBaseFee()]),r===void 0||r===!1?n.length===0:n.join(" ")},e}(),Zo=jo,Jo=hn,Yo={cacheIdentifierForPayload:Xo,canCache:bn,blockTagForPayload:Qo,paramsWithoutBlockTag:kn,blockTagParamIndex:tr,cacheTypeForPayload:Pn};function Xo(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!bn(e))return null;var r=t.includeBlockRef,n=r?e.params:kn(e);return e.method+":"+Jo(n)}function bn(e){return Pn(e)!=="never"}function Qo(e){var t=tr(e);return t>=e.params.length?null:e.params[t]}function kn(e){var t=tr(e);return t>=e.params.length?e.params:e.method==="eth_getBlockByNumber"?e.params.slice(1):e.params.slice(0,t)}function tr(e){switch(e.method){case"eth_getStorageAt":return 2;case"eth_getBalance":case"eth_getCode":case"eth_getTransactionCount":case"eth_call":case"eth_estimateGas":return 1;case"eth_getBlockByNumber":return 0;default:return}}function Pn(e){switch(e.method){case"web3_clientVersion":case"web3_sha3":case"eth_protocolVersion":case"eth_getBlockTransactionCountByHash":case"eth_getUncleCountByBlockHash":case"eth_getCode":case"eth_getBlockByHash":case"eth_getTransactionByHash":case"eth_getTransactionByBlockHashAndIndex":case"eth_getTransactionReceipt":case"eth_getUncleByBlockHashAndIndex":case"eth_getCompilers":case"eth_compileLLL":case"eth_compileSolidity":case"eth_compileSerpent":case"shh_version":return"perma";case"eth_getBlockByNumber":case"eth_getBlockTransactionCountByNumber":case"eth_getUncleCountByBlockNumber":case"eth_getTransactionByBlockNumberAndIndex":case"eth_getUncleByBlockNumberAndIndex":return"fork";case"eth_gasPrice":case"eth_getBalance":case"eth_getStorageAt":case"eth_getTransactionCount":case"eth_call":case"eth_estimateGas":case"eth_getFilterLogs":case"eth_getLogs":case"eth_blockNumber":return"block";case"net_version":case"net_peerCount":case"net_listening":case"eth_syncing":case"eth_sign":case"eth_coinbase":case"eth_mining":case"eth_hashrate":case"eth_accounts":case"eth_sendTransaction":case"eth_sendRawTransaction":case"eth_newFilter":case"eth_newBlockFilter":case"eth_newPendingTransactionFilter":case"eth_uninstallFilter":case"eth_getFilterChanges":case"eth_getWork":case"eth_submitWork":case"eth_submitHashrate":case"db_putString":case"db_getString":case"db_putHex":case"db_getHex":case"shh_post":case"shh_newIdentity":case"shh_hasIdentity":case"shh_newGroup":case"shh_addToGroup":case"shh_newFilter":case"shh_uninstallFilter":case"shh_getFilterChanges":case"shh_getMessages":return"never"}}var es=Q.inherits,ts=Zo,Se=ce,rs=ge,ns=Yo.blockTagForPayload,is=rr;es(rr,rs);function rr(e){var t=this;t.nonceCache={}}rr.prototype.handleRequest=function(e,t,r){var n=this;switch(e.method){case"eth_getTransactionCount":var i=ns(e),o=e.params[0].toLowerCase(),c=n.nonceCache[o];i==="pending"?c?r(null,c):t(function(f,u,s){if(f)return s();n.nonceCache[o]===void 0&&(n.nonceCache[o]=u),s()}):t();return;case"eth_sendRawTransaction":t(function(f,u,s){if(f)return s();var a=e.params[0];Se.stripHexPrefix(a),Buffer.from(Se.stripHexPrefix(a),"hex");var l=new ts(Buffer.from(Se.stripHexPrefix(a),"hex")),d="0x"+l.getSenderAddress().toString("hex").toLowerCase(),h=Se.bufferToInt(l.nonce);h++;var p=h.toString(16);p.length%2&&(p="0"+p),p="0x"+p,n.nonceCache[d]=p,s()});return;case"evm_revert":n.nonceCache={},t();return;default:t();return}};function Ee(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ee=function(r){return typeof r}:Ee=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Ee(e)}function as(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function os(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nr(e,t)}function nr(e,t){return nr=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},nr(e,t)}function ss(e){return function(){var t=Ce(e),r;if(fs()){var n=Ce(this).constructor;r=Reflect.construct(t,arguments,n)}else r=t.apply(this,arguments);return cs(this,r)}}function cs(e,t){return t&&(Ee(t)==="object"||typeof t=="function")?t:us(e)}function us(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fs(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function Ce(e){return Ce=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Ce(e)}var ls=qt,ds=In,hs=function(e){os(r,e);var t=ss(r);function r(){return as(this,r),t.call(this,function(n){var i=n.blockTracker,o=n.provider,c=n.engine,f=ds({blockTracker:i,provider:o}),u=f.events,s=f.middleware;return u.on("notification",function(a){return c.emit("data",null,a)}),s})}return r}(ls),ps=hs,Tn={},ir=se.exports.Buffer,Sn=Vr.Transform,vs=Kr.exports,gs=function(e){function t(r,n,i,o,c){Sn.call(this,c),this._rate=r,this._capacity=n,this._delimitedSuffix=i,this._hashBitLength=o,this._options=c,this._state=new e,this._state.initialize(r,n),this._finalized=!1}return vs(t,Sn),t.prototype._transform=function(r,n,i){var o=null;try{this.update(r,n)}catch(c){o=c}i(o)},t.prototype._flush=function(r){var n=null;try{this.push(this.digest())}catch(i){n=i}r(n)},t.prototype.update=function(r,n){if(!ir.isBuffer(r)&&typeof r!="string")throw new TypeError("Data must be a string or a buffer");if(this._finalized)throw new Error("Digest already called");return ir.isBuffer(r)||(r=ir.from(r,n)),this._state.absorb(r),this},t.prototype.digest=function(r){if(this._finalized)throw new Error("Digest already called");this._finalized=!0,this._delimitedSuffix&&this._state.absorbLastFewBits(this._delimitedSuffix);var n=this._state.squeeze(this._hashBitLength/8);return r!==void 0&&(n=n.toString(r)),this._resetState(),n},t.prototype._resetState=function(){return this._state.initialize(this._rate,this._capacity),this},t.prototype._clone=function(){var r=new t(this._rate,this._capacity,this._delimitedSuffix,this._hashBitLength,this._options);return this._state.copy(r._state),r._finalized=this._finalized,r},t},ar=se.exports.Buffer,En=Vr.Transform,ms=Kr.exports,ys=function(e){function t(r,n,i,o){En.call(this,o),this._rate=r,this._capacity=n,this._delimitedSuffix=i,this._options=o,this._state=new e,this._state.initialize(r,n),this._finalized=!1}return ms(t,En),t.prototype._transform=function(r,n,i){var o=null;try{this.update(r,n)}catch(c){o=c}i(o)},t.prototype._flush=function(){},t.prototype._read=function(r){this.push(this.squeeze(r))},t.prototype.update=function(r,n){if(!ar.isBuffer(r)&&typeof r!="string")throw new TypeError("Data must be a string or a buffer");if(this._finalized)throw new Error("Squeeze already called");return ar.isBuffer(r)||(r=ar.from(r,n)),this._state.absorb(r),this},t.prototype.squeeze=function(r,n){this._finalized||(this._finalized=!0,this._state.absorbLastFewBits(this._delimitedSuffix));var i=this._state.squeeze(r);return n!==void 0&&(i=i.toString(n)),i},t.prototype._resetState=function(){return this._state.initialize(this._rate,this._capacity),this},t.prototype._clone=function(){var r=new t(this._rate,this._capacity,this._delimitedSuffix,this._options);return this._state.copy(r._state),r._finalized=this._finalized,r},t},_s=gs,ws=ys,bs=function(e){var t=_s(e),r=ws(e);return function(n,i){var o=typeof n=="string"?n.toLowerCase():n;switch(o){case"keccak224":return new t(1152,448,null,224,i);case"keccak256":return new t(1088,512,null,256,i);case"keccak384":return new t(832,768,null,384,i);case"keccak512":return new t(576,1024,null,512,i);case"sha3-224":return new t(1152,448,6,224,i);case"sha3-256":return new t(1088,512,6,256,i);case"sha3-384":return new t(832,768,6,384,i);case"sha3-512":return new t(576,1024,6,512,i);case"shake128":return new r(1344,256,31,i);case"shake256":return new r(1088,512,31,i);default:throw new Error("Invald algorithm: "+n)}}},Cn={},An=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648];Cn.p1600=function(e){for(var t=0;t<24;++t){var r=e[0]^e[10]^e[20]^e[30]^e[40],n=e[1]^e[11]^e[21]^e[31]^e[41],i=e[2]^e[12]^e[22]^e[32]^e[42],o=e[3]^e[13]^e[23]^e[33]^e[43],c=e[4]^e[14]^e[24]^e[34]^e[44],f=e[5]^e[15]^e[25]^e[35]^e[45],u=e[6]^e[16]^e[26]^e[36]^e[46],s=e[7]^e[17]^e[27]^e[37]^e[47],a=e[8]^e[18]^e[28]^e[38]^e[48],l=e[9]^e[19]^e[29]^e[39]^e[49],d=a^(i<<1|o>>>31),h=l^(o<<1|i>>>31),p=e[0]^d,v=e[1]^h,g=e[10]^d,y=e[11]^h,m=e[20]^d,b=e[21]^h,_=e[30]^d,w=e[31]^h,T=e[40]^d,S=e[41]^h;d=r^(c<<1|f>>>31),h=n^(f<<1|c>>>31);var P=e[2]^d,H=e[3]^h,z=e[12]^d,ae=e[13]^h,X=e[22]^d,oe=e[23]^h,lr=e[32]^d,dr=e[33]^h,hr=e[42]^d,pr=e[43]^h;d=i^(u<<1|s>>>31),h=o^(s<<1|u>>>31);var vr=e[4]^d,gr=e[5]^h,mr=e[14]^d,yr=e[15]^h,_r=e[24]^d,wr=e[25]^h,br=e[34]^d,kr=e[35]^h,Pr=e[44]^d,Tr=e[45]^h;d=c^(a<<1|l>>>31),h=f^(l<<1|a>>>31);var Sr=e[6]^d,Er=e[7]^h,Cr=e[16]^d,Ar=e[17]^h,Rr=e[26]^d,Or=e[27]^h,Lr=e[36]^d,Mr=e[37]^h,xr=e[46]^d,Br=e[47]^h;d=u^(r<<1|n>>>31),h=s^(n<<1|r>>>31);var Ir=e[8]^d,Nr=e[9]^h,Gr=e[18]^d,Dr=e[19]^h,Wr=e[28]^d,$r=e[29]^h,Fr=e[38]^d,Ur=e[39]^h,Hr=e[48]^d,zr=e[49]^h,Oe=p,Le=v,Me=y<<4|g>>>28,xe=g<<4|y>>>28,Be=m<<3|b>>>29,Ie=b<<3|m>>>29,Ne=w<<9|_>>>23,Ge=_<<9|w>>>23,De=T<<18|S>>>14,We=S<<18|T>>>14,$e=P<<1|H>>>31,Fe=H<<1|P>>>31,Ue=ae<<12|z>>>20,He=z<<12|ae>>>20,ze=X<<10|oe>>>22,qe=oe<<10|X>>>22,Ke=dr<<13|lr>>>19,Ve=lr<<13|dr>>>19,je=hr<<2|pr>>>30,Ze=pr<<2|hr>>>30,Je=gr<<30|vr>>>2,Ye=vr<<30|gr>>>2,Xe=mr<<6|yr>>>26,Qe=yr<<6|mr>>>26,et=wr<<11|_r>>>21,tt=_r<<11|wr>>>21,rt=br<<15|kr>>>17,nt=kr<<15|br>>>17,it=Tr<<29|Pr>>>3,at=Pr<<29|Tr>>>3,ot=Sr<<28|Er>>>4,st=Er<<28|Sr>>>4,ct=Ar<<23|Cr>>>9,ut=Cr<<23|Ar>>>9,ft=Rr<<25|Or>>>7,lt=Or<<25|Rr>>>7,dt=Lr<<21|Mr>>>11,ht=Mr<<21|Lr>>>11,pt=Br<<24|xr>>>8,vt=xr<<24|Br>>>8,gt=Ir<<27|Nr>>>5,mt=Nr<<27|Ir>>>5,yt=Gr<<20|Dr>>>12,_t=Dr<<20|Gr>>>12,wt=$r<<7|Wr>>>25,bt=Wr<<7|$r>>>25,kt=Fr<<8|Ur>>>24,Pt=Ur<<8|Fr>>>24,Tt=Hr<<14|zr>>>18,St=zr<<14|Hr>>>18;e[0]=Oe^~Ue&et,e[1]=Le^~He&tt,e[10]=ot^~yt&Be,e[11]=st^~_t&Ie,e[20]=$e^~Xe&ft,e[21]=Fe^~Qe&lt,e[30]=gt^~Me&ze,e[31]=mt^~xe&qe,e[40]=Je^~ct&wt,e[41]=Ye^~ut&bt,e[2]=Ue^~et&dt,e[3]=He^~tt&ht,e[12]=yt^~Be&Ke,e[13]=_t^~Ie&Ve,e[22]=Xe^~ft&kt,e[23]=Qe^~lt&Pt,e[32]=Me^~ze&rt,e[33]=xe^~qe&nt,e[42]=ct^~wt&Ne,e[43]=ut^~bt&Ge,e[4]=et^~dt&Tt,e[5]=tt^~ht&St,e[14]=Be^~Ke&it,e[15]=Ie^~Ve&at,e[24]=ft^~kt&De,e[25]=lt^~Pt&We,e[34]=ze^~rt&pt,e[35]=qe^~nt&vt,e[44]=wt^~Ne&je,e[45]=bt^~Ge&Ze,e[6]=dt^~Tt&Oe,e[7]=ht^~St&Le,e[16]=Ke^~it&ot,e[17]=Ve^~at&st,e[26]=kt^~De&$e,e[27]=Pt^~We&Fe,e[36]=rt^~pt&gt,e[37]=nt^~vt&mt,e[46]=Ne^~je&Je,e[47]=Ge^~Ze&Ye,e[8]=Tt^~Oe&Ue,e[9]=St^~Le&He,e[18]=it^~ot&yt,e[19]=at^~st&_t,e[28]=De^~$e&Xe,e[29]=We^~Fe&Qe,e[38]=pt^~gt&Me,e[39]=vt^~mt&xe,e[48]=je^~Je&ct,e[49]=Ze^~Ye&ut,e[0]^=An[t*2],e[1]^=An[t*2+1]}};var ks=se.exports.Buffer,Ae=Cn;function J(){this.state=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.blockSize=null,this.count=0,this.squeezing=!1}J.prototype.initialize=function(e,t){for(var r=0;r<50;++r)this.state[r]=0;this.blockSize=e/8,this.count=0,this.squeezing=!1};J.prototype.absorb=function(e){for(var t=0;t<e.length;++t)this.state[~~(this.count/4)]^=e[t]<<8*(this.count%4),this.count+=1,this.count===this.blockSize&&(Ae.p1600(this.state),this.count=0)};J.prototype.absorbLastFewBits=function(e){this.state[~~(this.count/4)]^=e<<8*(this.count%4),(e&128)!=0&&this.count===this.blockSize-1&&Ae.p1600(this.state),this.state[~~((this.blockSize-1)/4)]^=128<<8*((this.blockSize-1)%4),Ae.p1600(this.state),this.count=0,this.squeezing=!0};J.prototype.squeeze=function(e){this.squeezing||this.absorbLastFewBits(1);for(var t=ks.alloc(e),r=0;r<e;++r)t[r]=this.state[~~(this.count/4)]>>>8*(this.count%4)&255,this.count+=1,this.count===this.blockSize&&(Ae.p1600(this.state),this.count=0);return t};J.prototype.copy=function(e){for(var t=0;t<50;++t)e.state[t]=this.state[t];e.blockSize=this.blockSize,e.count=this.count,e.squeezing=this.squeezing};var Ps=J,Ts=bs(Ps);(function(e){var t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},r=Ts,n=Fn,i=Nn,o=Un,c=Mn.exports,f=Hn,u=se.exports.Buffer;Object.assign(e,$n),e.MAX_INTEGER=new c("ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",16),e.TWO_POW256=new c("10000000000000000000000000000000000000000000000000000000000000000",16),e.KECCAK256_NULL_S="c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",e.SHA3_NULL_S=e.KECCAK256_NULL_S,e.KECCAK256_NULL=u.from(e.KECCAK256_NULL_S,"hex"),e.SHA3_NULL=e.KECCAK256_NULL,e.KECCAK256_RLP_ARRAY_S="1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",e.SHA3_RLP_ARRAY_S=e.KECCAK256_RLP_ARRAY_S,e.KECCAK256_RLP_ARRAY=u.from(e.KECCAK256_RLP_ARRAY_S,"hex"),e.SHA3_RLP_ARRAY=e.KECCAK256_RLP_ARRAY,e.KECCAK256_RLP_S="56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",e.SHA3_RLP_S=e.KECCAK256_RLP_S,e.KECCAK256_RLP=u.from(e.KECCAK256_RLP_S,"hex"),e.SHA3_RLP=e.KECCAK256_RLP,e.BN=c,e.rlp=o,e.secp256k1=n,e.zeros=function(a){return u.allocUnsafe(a).fill(0)},e.zeroAddress=function(){var a=20,l=e.zeros(a);return e.bufferToHex(l)},e.setLengthLeft=e.setLength=function(a,l,d){var h=e.zeros(l);return a=e.toBuffer(a),d?a.length<l?(a.copy(h),h):a.slice(0,l):a.length<l?(a.copy(h,l-a.length),h):a.slice(-l)},e.setLengthRight=function(a,l){return e.setLength(a,l,!0)},e.unpad=e.stripZeros=function(a){a=e.stripHexPrefix(a);for(var l=a[0];a.length>0&&l.toString()==="0";)a=a.slice(1),l=a[0];return a},e.toBuffer=function(a){if(!u.isBuffer(a))if(Array.isArray(a))a=u.from(a);else if(typeof a=="string")e.isHexString(a)?a=u.from(e.padToEven(e.stripHexPrefix(a)),"hex"):a=u.from(a);else if(typeof a=="number")a=e.intToBuffer(a);else if(a==null)a=u.allocUnsafe(0);else if(c.isBN(a))a=a.toArrayLike(u);else if(a.toArray)a=u.from(a.toArray());else throw new Error("invalid type");return a},e.bufferToInt=function(a){return new c(e.toBuffer(a)).toNumber()},e.bufferToHex=function(a){return a=e.toBuffer(a),"0x"+a.toString("hex")},e.fromSigned=function(a){return new c(a).fromTwos(256)},e.toUnsigned=function(a){return u.from(a.toTwos(256).toArray())},e.keccak=function(a,l){return a=e.toBuffer(a),l||(l=256),r("keccak"+l).update(a).digest()},e.keccak256=function(a){return e.keccak(a)},e.sha3=e.keccak,e.sha256=function(a){return a=e.toBuffer(a),f("sha256").update(a).digest()},e.ripemd160=function(a,l){a=e.toBuffer(a);var d=f("rmd160").update(a).digest();return l===!0?e.setLength(d,32):d},e.rlphash=function(a){return e.keccak(o.encode(a))},e.isValidPrivate=function(a){return n.privateKeyVerify(a)},e.isValidPublic=function(a,l){return a.length===64?n.publicKeyVerify(u.concat([u.from([4]),a])):l?n.publicKeyVerify(a):!1},e.pubToAddress=e.publicToAddress=function(a,l){return a=e.toBuffer(a),l&&a.length!==64&&(a=n.publicKeyConvert(a,!1).slice(1)),i(a.length===64),e.keccak(a).slice(-20)};var s=e.privateToPublic=function(a){return a=e.toBuffer(a),n.publicKeyCreate(a,!1).slice(1)};e.importPublic=function(a){return a=e.toBuffer(a),a.length!==64&&(a=n.publicKeyConvert(a,!1).slice(1)),a},e.ecsign=function(a,l){var d=n.sign(a,l),h={};return h.r=d.signature.slice(0,32),h.s=d.signature.slice(32,64),h.v=d.recovery+27,h},e.hashPersonalMessage=function(a){var l=e.toBuffer(`Ethereum Signed Message:
`+a.length.toString());return e.keccak(u.concat([l,a]))},e.ecrecover=function(a,l,d,h){var p=u.concat([e.setLength(d,32),e.setLength(h,32)],64),v=l-27;if(v!==0&&v!==1)throw new Error("Invalid signature v value");var g=n.recover(a,p,v);return n.publicKeyConvert(g,!1).slice(1)},e.toRpcSig=function(a,l,d){if(a!==27&&a!==28)throw new Error("Invalid recovery id");return e.bufferToHex(u.concat([e.setLengthLeft(l,32),e.setLengthLeft(d,32),e.toBuffer(a-27)]))},e.fromRpcSig=function(a){if(a=e.toBuffer(a),a.length!==65)throw new Error("Invalid signature length");var l=a[64];return l<27&&(l+=27),{v:l,r:a.slice(0,32),s:a.slice(32,64)}},e.privateToAddress=function(a){return e.publicToAddress(s(a))},e.isValidAddress=function(a){return/^0x[0-9a-fA-F]{40}$/.test(a)},e.isZeroAddress=function(a){var l=e.zeroAddress();return l===e.addHexPrefix(a)},e.toChecksumAddress=function(a){a=e.stripHexPrefix(a).toLowerCase();for(var l=e.keccak(a).toString("hex"),d="0x",h=0;h<a.length;h++)parseInt(l[h],16)>=8?d+=a[h].toUpperCase():d+=a[h];return d},e.isValidChecksumAddress=function(a){return e.isValidAddress(a)&&e.toChecksumAddress(a)===a},e.generateAddress=function(a,l){return a=e.toBuffer(a),l=new c(l),l.isZero()?l=null:l=u.from(l.toArray()),e.rlphash([a,l]).slice(-20)},e.isPrecompiled=function(a){var l=e.unpad(a);return l.length===1&&l[0]>=1&&l[0]<=8},e.addHexPrefix=function(a){return typeof a!="string"||e.isHexPrefixed(a)?a:"0x"+a},e.isValidSignature=function(a,l,d,h){var p=new c("7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a0",16),v=new c("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",16);return!(l.length!==32||d.length!==32||a!==27&&a!==28||(l=new c(l),d=new c(d),l.isZero()||l.gt(v)||d.isZero()||d.gt(v))||h===!1&&new c(d).cmp(p)===1)},e.baToJSON=function(a){if(u.isBuffer(a))return"0x"+a.toString("hex");if(a instanceof Array){for(var l=[],d=0;d<a.length;d++)l.push(e.baToJSON(a[d]));return l}},e.defineProperties=function(a,l,d){if(a.raw=[],a._fields=[],a.toJSON=function(p){if(p){var v={};return a._fields.forEach(function(g){v[g]="0x"+a[g].toString("hex")}),v}return e.baToJSON(this.raw)},a.serialize=function(){return o.encode(a.raw)},l.forEach(function(p,v){a._fields.push(p.name);function g(){return a.raw[v]}function y(m){m=e.toBuffer(m),m.toString("hex")==="00"&&!p.allowZero&&(m=u.allocUnsafe(0)),p.allowLess&&p.length?(m=e.stripZeros(m),i(p.length>=m.length,"The field "+p.name+" must not have more "+p.length+" bytes")):!(p.allowZero&&m.length===0)&&p.length&&i(p.length===m.length,"The field "+p.name+" must have byte length of "+p.length),a.raw[v]=m}Object.defineProperty(a,p.name,{enumerable:!0,configurable:!0,get:g,set:y}),p.default&&(a[p.name]=p.default),p.alias&&Object.defineProperty(a,p.alias,{enumerable:!1,configurable:!0,set:y,get:g})}),d)if(typeof d=="string"&&(d=u.from(e.stripHexPrefix(d),"hex")),u.isBuffer(d)&&(d=o.decode(d)),Array.isArray(d)){if(d.length>a._fields.length)throw new Error("wrong number of fields in data");d.forEach(function(p,v){a[a._fields[v]]=e.toBuffer(p)})}else if((typeof d=="undefined"?"undefined":t(d))==="object"){var h=Object.keys(d);l.forEach(function(p){h.indexOf(p.name)!==-1&&(a[p.name]=d[p.name]),h.indexOf(p.alias)!==-1&&(a[p.alias]=d[p.alias])})}else throw new Error("invalid data")}})(Tn);var or=globalThis&&globalThis.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function c(s){try{u(n.next(s))}catch(a){o(a)}}function f(s){try{u(n.throw(s))}catch(a){o(a)}}function u(s){s.done?i(s.value):new r(function(a){a(s.value)}).then(c,f)}u((n=n.apply(e,t||[])).next())})},sr=globalThis&&globalThis.__generator||function(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,c;return c={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function f(s){return function(a){return u([s,a])}}function u(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=s[0]&2?i.return:s[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,s[1])).done)return o;switch(i=0,o&&(s=[s[0]&2,o.value]),s[0]){case 0:case 1:o=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,i=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!o||s[1]>o[0]&&s[1]<o[3])){r.label=s[1];break}if(s[0]===6&&r.label<o[1]){r.label=o[1],o=s;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(s);break}o[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(a){s=[6,a],i=0}finally{n=o=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},cr=Tn,Rn=cr.addHexPrefix,Ss=cr.stripHexPrefix,ur=cr.BN,Es="0x5208";function Cs(e,t){return or(this,void 0,void 0,function(){var r,n,i,o,c,f;return sr(this,function(u){switch(u.label){case 0:return[4,e.getBlockByNumber("latest",!1)];case 1:return r=u.sent(),[4,As(e,t,r.gasLimit)];case 2:if(n=u.sent(),i=n.safeGas,o=n.simpleSend,c=n.gasLimitSpecified,o||c)return[2,i];u.label=3;case 3:return u.trys.push([3,5,,6]),[4,Rs(e,t,r.gasLimit,i)];case 4:return f=u.sent(),[2,f];case 5:return u.sent(),[2,i];case 6:return[2]}})})}function As(e,t,r){return or(this,void 0,void 0,function(){var n,i,o,c,f,u,s,a;return sr(this,function(l){switch(l.label){case 0:return n=Boolean(t.gas),n?[2,{safeGas:t.gas,simpleSend:!1,gasLimitSpecified:!0}]:(i=t.to,o=Boolean(i),o?[4,e.getCode(i)]:[3,2]);case 1:if(c=l.sent(),f=!c||c==="0x"||c==="0x0",f){if(t.data)throw u=new Error("Trying to call a function on a non-contract address"),u;return[2,{safeGas:Es,simpleSend:!0,gasLimitSpecified:!1}]}l.label=2;case 2:return s=fr(r),a=Ls(s,19,20),[2,{safeGas:Re(a),simpleSend:!1,gasLimitSpecified:!1}]}})})}function Rs(e,t,r,n){return or(this,void 0,void 0,function(){var i,o;return sr(this,function(c){switch(c.label){case 0:return t.gas=n,o=Rn,[4,e.estimateGas(t)];case 1:return i=o.apply(void 0,[c.sent()]),[2,Os(i,r)]}})})}function Os(e,t){var r=fr(e),n=fr(t),i=n.muln(.9),o=r.muln(1.5);return r.gt(i)?Re(r):o.lt(i)?Re(o):Re(i)}function fr(e){return new ur(Ss(e),16)}function Re(e){return Rn(e.toString(16))}function Ls(e,t,r){var n=new ur(t),i=new ur(r);return e.mul(n).div(i)}var Ms=function(){function e(t){this.provider=t}return e.prototype.getBlockByNumber=function(t,r){return this.sendAsync("eth_getBlockByNumber",t,r)},e.prototype.getCode=function(t,r){return r===void 0&&(r="latest"),this.sendAsync("eth_getCode",t,r)},e.prototype.estimateGas=function(t){return this.sendAsync("eth_estimateGas",t)},e.prototype.sendAsync=function(t){for(var r=this,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];return new Promise(function(o,c){r.provider.sendAsync({id:42,jsonrpc:"2.0",method:t,params:n},function(f,u){f?c(f):o(u.result)})})},e}(),Y=globalThis&&globalThis.__assign||function(){return Y=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Y.apply(this,arguments)},I=globalThis&&globalThis.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function c(s){try{u(n.next(s))}catch(a){o(a)}}function f(s){try{u(n.throw(s))}catch(a){o(a)}}function u(s){s.done?i(s.value):new r(function(a){a(s.value)}).then(c,f)}u((n=n.apply(e,t||[])).next())})},N=globalThis&&globalThis.__generator||function(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,c;return c={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function f(s){return function(a){return u([s,a])}}function u(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=s[0]&2?i.return:s[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,s[1])).done)return o;switch(i=0,o&&(s=[s[0]&2,o.value]),s[0]){case 0:case 1:o=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,i=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!o||s[1]>o[0]&&s[1]<o[3])){r.label=s[1];break}if(s[0]===6&&r.label<o[1]){r.label=o[1],o=s;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(s);break}o[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(a){s=[6,a],i=0}finally{n=o=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},xs=xi,On=va,Bs=ya,Is=Aa,Ns=Wa,Ln=is,Gs=ps,Ds=function(){function e(t,r){this.config=t,this._getWidgetCommunication=r,this.provider=this._initProvider()}return e.prototype.setSelectedAddress=function(t){this._selectedAddress=t},e.prototype.changeNetwork=function(t,r){var n=jr(t,r);this.clearSubprovider(Ln),this.clearSubprovider(On),this.config.network=n},e.prototype._initProvider=function(){var t=this;if(this.engine)return this.engine;this.engine=new xs;var r=new Ms(this.engine);return this.engine.send=function(n,i){if(typeof n=="string")return new Promise(function(f,u){t.engine.sendAsync({jsonrpc:"2.0",id:42,method:n,params:i||[]},function(s,a){s?u(s):f(a.result)})});if(i){t.engine.sendAsync(n,i);return}var o=null;switch(n.method){case"eth_accounts":o=t._selectedAddress?[t._selectedAddress]:[];break;case"eth_coinbase":o=t._selectedAddress?[t._selectedAddress]:[];break;case"net_version":o=t._network;break;case"eth_uninstallFilter":t.engine.sendAsync(n,function(f){return f}),o=!0;break;default:var c="The Portis Web3 object does not support synchronous methods like "+n.method+" without a callback parameter.";throw new Error(c)}return{id:n.id,jsonrpc:n.jsonrpc,result:o}},this.engine.addProvider(new Bs({web3_clientVersion:"Portis/v"+this.config.version+"/javascript",net_listening:!0,eth_hashrate:"0x00",eth_mining:!1,eth_syncing:!0})),this.engine.addProvider(new On),this.engine.addProvider(new Gs),this.engine.addProvider(new Is),this.engine.addProvider(new Ln),this.engine.addProvider({setEngine:function(n){return n},handleRequest:function(n,i){return I(t,void 0,void 0,function(){return N(this,function(o){return n.id||(n.id=42),i(),[2]})})}}),this.engine.addProvider(new Ns({getAccounts:function(n){return I(t,void 0,void 0,function(){var i,o,c,f;return N(this,function(u){switch(u.label){case 0:return[4,this._getWidgetCommunication()];case 1:return i=u.sent(),[4,i.getAccounts(this.config)];case 2:return o=u.sent(),c=o.error,f=o.result,!c&&f&&(this._selectedAddress=f[0]),n(c,f),[2]}})})},signTransaction:function(n,i){return I(t,void 0,void 0,function(){var o,c,f,u;return N(this,function(s){switch(s.label){case 0:return[4,this._getWidgetCommunication()];case 1:return o=s.sent(),[4,o.signTransaction(n,this.config)];case 2:return c=s.sent(),f=c.error,u=c.result,i(f,u),[2]}})})},signMessage:function(n,i){return I(t,void 0,void 0,function(){var o,c,f,u,s;return N(this,function(a){switch(a.label){case 0:return[4,this._getWidgetCommunication()];case 1:return o=a.sent(),c=Y({},n,{messageStandard:"signMessage"}),[4,o.signMessage(c,this.config)];case 2:return f=a.sent(),u=f.error,s=f.result,i(u,s),[2]}})})},signPersonalMessage:function(n,i){return I(t,void 0,void 0,function(){var o,c,f,u,s;return N(this,function(a){switch(a.label){case 0:return[4,this._getWidgetCommunication()];case 1:return o=a.sent(),c=Y({},n,{messageStandard:"signPersonalMessage"}),[4,o.signMessage(c,this.config)];case 2:return f=a.sent(),u=f.error,s=f.result,i(u,s),[2]}})})},signTypedMessage:function(n,i){return I(t,void 0,void 0,function(){var o,c,f,u,s;return N(this,function(a){switch(a.label){case 0:return[4,this._getWidgetCommunication()];case 1:return o=a.sent(),c=Y({},n,{messageStandard:"signTypedMessage"}),[4,o.signMessage(c,this.config)];case 2:return f=a.sent(),u=f.error,s=f.result,i(u,s),[2]}})})},signTypedMessageV3:function(n,i){return I(t,void 0,void 0,function(){var o,c,f,u,s;return N(this,function(a){switch(a.label){case 0:return[4,this._getWidgetCommunication()];case 1:return o=a.sent(),c=Y({},n,{messageStandard:"signTypedMessageV3"}),[4,o.signMessage(c,this.config)];case 2:return f=a.sent(),u=f.error,s=f.result,i(u,s),[2]}})})},estimateGas:function(n,i){return I(t,void 0,void 0,function(){var o;return N(this,function(c){switch(c.label){case 0:return[4,Cs(r,n)];case 1:return o=c.sent(),i(null,o),[2]}})})},getGasPrice:function(n){return I(t,void 0,void 0,function(){return N(this,function(i){return n(null,""),[2]})})}})),this.engine.addProvider({setEngine:function(n){return n},handleRequest:function(n,i,o){return I(t,void 0,void 0,function(){var c,f,u,s;return N(this,function(a){switch(a.label){case 0:return[4,this._getWidgetCommunication()];case 1:return c=a.sent(),[4,c.relay(n,this.config)];case 2:return f=a.sent(),u=f.error,s=f.result,n.method==="net_version"&&(this._network=s,this.engine.networkVersion=this._network),o(u,s),[2]}})})}}),this.engine.enable=function(){return new Promise(function(n,i){t.engine.sendAsync({method:"eth_accounts"},function(o,c){o?i(o):n(c.result)})})},this.engine.isConnected=function(){return!0},this.engine.isPortis=!0,this.engine.on("error",function(n){n&&n.message&&n.message.includes("PollingBlockTracker")?console.warn("If you see this warning constantly, there might be an error with your RPC node."):console.error(n)}),this.engine.start(),this.engine},e.prototype.clearSubprovider=function(t){var r=this.provider._providers.find(function(n){return n instanceof t});this.provider.removeProvider(r),this.provider.addProvider(new t)},e}(),Ws=function(e){return new Proxy(e,{get:function(t,r){if(t[r]instanceof Function)return function(){}}})},L=globalThis&&globalThis.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function c(s){try{u(n.next(s))}catch(a){o(a)}}function f(s){try{u(n.throw(s))}catch(a){o(a)}}function u(s){s.done?i(s.value):new r(function(a){a(s.value)}).then(c,f)}u((n=n.apply(e,t||[])).next())})},M=globalThis&&globalThis.__generator||function(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,c;return c={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function f(s){return function(a){return u([s,a])}}function u(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=s[0]&2?i.return:s[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,s[1])).done)return o;switch(i=0,o&&(s=[s[0]&2,o.value]),s[0]){case 0:case 1:o=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,i=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!o||s[1]>o[0]&&s[1]<o[3])){r.label=s[1];break}if(s[0]===6&&r.label<o[1]){r.label=o[1],o=s;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(s);break}o[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(a){s=[6,a],i=0}finally{n=o=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},$s="4.1.0",Fs=["email","reputation"];Jr().then(ii).catch(function(){});var Xs=function(){function e(t,r,n){if(n===void 0&&(n={}),!Zr())return Ws(this);Yr(),this._validateParams(t,r,n),this._config={dappId:t,network:jr(r,n.gasRelay),version:$s,scope:n.scope,registerPageByDefault:n.registerPageByDefault,staging:n.staging},this._getWidgetCommunication=this._getWidgetCommunication.bind(this),this._widgetManagerInstance=new ai(this.config,this._clearProviderSession),this._web3ManagerInstance=new Ds(this.config,this._getWidgetCommunication),this.setDefaultEmail=this.setDefaultEmail.bind(this),this.changeNetwork=this.changeNetwork.bind(this),this.getWidget=this.getWidget.bind(this),this.onLogin=this.onLogin.bind(this),this.onLogout=this.onLogout.bind(this),this.onActiveWalletChanged=this.onActiveWalletChanged.bind(this),this.onError=this.onError.bind(this),this.showPortis=this.showPortis.bind(this),this.getCampaignInfo=this.getCampaignInfo.bind(this),this.claimVoucher=this.claimVoucher.bind(this),this.getExtendedPublicKey=this.getExtendedPublicKey.bind(this),this.importWallet=this.importWallet.bind(this),this.isLoggedIn=this.isLoggedIn.bind(this),this.signBitcoinTransaction=this.signBitcoinTransaction.bind(this),this.showBitcoinWallet=this.showBitcoinWallet.bind(this),this.purchaseERC20=this.purchaseERC20.bind(this)}return Object.defineProperty(e.prototype,"_widgetManager",{get:function(){return this._widgetManagerInstance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_web3Manager",{get:function(){return this._web3ManagerInstance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),e.prototype._clearProviderSession=function(){this._web3Manager.setSelectedAddress("")},e.prototype._getWidgetCommunication=function(){return L(this,void 0,void 0,function(){return M(this,function(t){switch(t.label){case 0:return[4,this._widgetManager.getWidget()];case 1:return[2,t.sent().communication]}})})},Object.defineProperty(e.prototype,"web3Provider",{get:function(){return this._web3Manager.provider},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"provider",{get:function(){return this.web3Provider},enumerable:!0,configurable:!0}),e.prototype.changeNetwork=function(t,r){this._web3Manager.changeNetwork(t,r)},e.prototype.setDefaultEmail=function(t){this._widgetManager.setDefaultEmail(t)},e.prototype.getWidget=function(){return L(this,void 0,void 0,function(){return M(this,function(t){return[2,this._widgetManager.getWidget()]})})},e.prototype.onLogin=function(t){this._widgetManager.setOnLoginCallback(t)},e.prototype.onLogout=function(t){this._widgetManager.setOnLogoutCallback(t)},e.prototype.onActiveWalletChanged=function(t){this._widgetManager.setOnActiveWalletChangedCallback(t)},e.prototype.onError=function(t){this._widgetManager.setOnErrorCallback(t)},e.prototype.showPortis=function(){return L(this,void 0,void 0,function(){return M(this,function(t){return[2,this._widgetManager.showPortis()]})})},e.prototype.getCampaignInfo=function(t){return L(this,void 0,void 0,function(){return M(this,function(r){return[2,this._widgetManager.getCampaignInfo(t)]})})},e.prototype.claimVoucher=function(t){return L(this,void 0,void 0,function(){return M(this,function(r){return[2,this._widgetManager.claimVoucher(t)]})})},e.prototype.logout=function(){return L(this,void 0,void 0,function(){return M(this,function(t){return[2,this._widgetManager.logout()]})})},e.prototype.getExtendedPublicKey=function(t,r){return t===void 0&&(t="m/44'/60'/0'/0/0"),r===void 0&&(r="Ethereum"),L(this,void 0,void 0,function(){return M(this,function(n){return[2,this._widgetManager.getExtendedPublicKey(t,r)]})})},e.prototype.importWallet=function(t){return L(this,void 0,void 0,function(){return M(this,function(r){return[2,this._widgetManager.importWallet(t)]})})},e.prototype.isLoggedIn=function(){return L(this,void 0,void 0,function(){return M(this,function(t){return[2,this._widgetManager.isLoggedIn()]})})},e.prototype.signBitcoinTransaction=function(t){return L(this,void 0,void 0,function(){return M(this,function(r){return[2,this._widgetManager.signBitcoinTransaction(t)]})})},e.prototype.showBitcoinWallet=function(t){return t===void 0&&(t="m/49'/0'/0'/0/0"),L(this,void 0,void 0,function(){return M(this,function(r){return[2,this._widgetManager.showBitcoinWallet(t)]})})},e.prototype.purchaseERC20=function(t,r,n,i){return L(this,void 0,void 0,function(){return M(this,function(o){return[2,this._widgetManager.purchaseERC20({tokenAddress:t,amount:r,tokenSymbol:n,logoURL:i})]})})},e.prototype._validateParams=function(t,r,n){if(!t)throw new Error("[Portis] 'dappId' is required. Get your dappId here: https://dashboard.portis.io");if(!r)throw new Error("[Portis] 'network' is required. Read more about it here: https://docs.portis.io/#/configuration?id=network");if(n.scope){if(!Array.isArray(n.scope))throw new Error("[Portis] 'scope' must be an array. Read more about it here: https://docs.portis.io/#/configuration?id=scope");var i=n.scope.filter(function(o){return Fs.indexOf(o)<0});if(i.length>0)throw new Error("[Portis] invalid 'scope' parameter. Read more about it here: https://docs.portis.io/#/configuration?id=scope")}if(n.registerPageByDefault!==void 0&&typeof n.registerPageByDefault!="boolean")throw new Error("[Portis] invalid 'registerPageByDefault' parameter, must be a boolean. Read more about it here: https://docs.portis.io/#/configuration?id=registerPageByDefault")},e}();export{Xs as default};
