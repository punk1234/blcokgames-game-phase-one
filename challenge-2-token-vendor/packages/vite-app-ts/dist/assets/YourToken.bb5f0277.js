import{C as ce,c as de,_ as j,a as Me,b as $e,d as Re,e as ye,f as xe,r as ke,R as Ve,S as He,u as De,g as Se,h as Ye,i as We,t as Ke,j as Ce,k as Xe,p as H,l as qe,m as te,B as $,D as Te,I as ue,n as ne,A as Ge,o as be,q as Ue}from"./Main.7fda9d8a.js";import{X as _e,aa as Je,B as Ee}from"./App.929567af.js";import{r as t,_ as R}from"./vendor.1a767ab4.js";import{j as y,F as Pe,a}from"./main.4b445710.js";import"./chunk-MTWSNRX5.47c61f42.js";import{u as Qe}from"./useBreakpoint.83a2d949.js";import{P as Ze}from"./Pagination.853a1132.js";import"./index.81f197fe.js";import"./LeftOutlined.2d634cb7.js";import"./index.35bcdefd.js";import"./DownOutlined.3659823a.js";var Ne=globalThis&&globalThis.__rest||function(n,r){var l={};for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&r.indexOf(e)<0&&(l[e]=n[e]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,e=Object.getOwnPropertySymbols(n);o<e.length;o++)r.indexOf(e[o])<0&&Object.prototype.propertyIsEnumerable.call(n,e[o])&&(l[e[o]]=n[e[o]]);return l},et=function(r){var l=r.prefixCls,e=r.className,o=r.avatar,p=r.title,b=r.description,i=Ne(r,["prefixCls","className","avatar","title","description"]),x=t.exports.useContext(ce),E=x.getPrefixCls,m=E("list",l),P=de("".concat(m,"-item-meta"),e),I=t.exports.createElement("div",{className:"".concat(m,"-item-meta-content")},p&&t.exports.createElement("h4",{className:"".concat(m,"-item-meta-title")},p),b&&t.exports.createElement("div",{className:"".concat(m,"-item-meta-description")},b));return t.exports.createElement("div",R({},i,{className:P}),o&&t.exports.createElement("div",{className:"".concat(m,"-item-meta-avatar")},o),(p||b)&&I)},Ae=function(r){var l=r.prefixCls,e=r.children,o=r.actions,p=r.extra,b=r.className,i=r.colStyle,x=Ne(r,["prefixCls","children","actions","extra","className","colStyle"]),E=t.exports.useContext(pe),m=E.grid,P=E.itemLayout,I=t.exports.useContext(ce),c=I.getPrefixCls,h=function(){var k;return t.exports.Children.forEach(e,function(L){typeof L=="string"&&(k=!0)}),k&&t.exports.Children.count(e)>1},N=function(){return P==="vertical"?!!p:!h()},C=c("list",l),g=o&&o.length>0&&t.exports.createElement("ul",{className:"".concat(C,"-item-action"),key:"actions"},o.map(function(O,k){return t.exports.createElement("li",{key:"".concat(C,"-item-action-").concat(k)},O,k!==o.length-1&&t.exports.createElement("em",{className:"".concat(C,"-item-action-split")}))})),F=m?"div":"li",A=t.exports.createElement(F,R({},x,{className:de("".concat(C,"-item"),j({},"".concat(C,"-item-no-flex"),!N()),b)}),P==="vertical"&&p?[t.exports.createElement("div",{className:"".concat(C,"-item-main"),key:"content"},e,g),t.exports.createElement("div",{className:"".concat(C,"-item-extra"),key:"extra"},p)]:[e,g,Me(p,{key:"extra"})]);return m?t.exports.createElement($e,{flex:1,style:i},A):A};Ae.Meta=et;var tt=Ae,nt=globalThis&&globalThis.__rest||function(n,r){var l={};for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&r.indexOf(e)<0&&(l[e]=n[e]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,e=Object.getOwnPropertySymbols(n);o<e.length;o++)r.indexOf(e[o])<0&&Object.prototype.propertyIsEnumerable.call(n,e[o])&&(l[e[o]]=n[e[o]]);return l},pe=t.exports.createContext({});pe.Consumer;function me(n){var r,l=n.pagination,e=l===void 0?!1:l,o=n.prefixCls,p=n.bordered,b=p===void 0?!1:p,i=n.split,x=i===void 0?!0:i,E=n.className,m=n.children,P=n.itemLayout,I=n.loadMore,c=n.grid,h=n.dataSource,N=h===void 0?[]:h,C=n.size,g=n.header,F=n.footer,A=n.loading,O=A===void 0?!1:A,k=n.rowKey,L=n.renderItem,X=n.locale,D=nt(n,["pagination","prefixCls","bordered","split","className","children","itemLayout","loadMore","grid","dataSource","size","header","footer","loading","rowKey","renderItem","locale"]),B=e&&Re(e)==="object"?e:{},Y=t.exports.useState(B.defaultCurrent||1),q=ye(Y,2),S=q[0],re=q[1],G=t.exports.useState(B.defaultPageSize||10),W=ye(G,2),M=W[0],U=W[1],K=t.exports.useContext(ce),ae=K.getPrefixCls,_=K.renderEmpty,oe=K.direction,J={current:1,total:0},s={},f=function(d){return function(z,w){re(z),U(w),e&&e[d]&&e[d](z,w)}},Be=f("onChange"),we=f("onShowSizeChange"),je=function(d,z){if(!L)return null;var w;return typeof k=="function"?w=k(d):typeof k=="string"?w=d[k]:w=d.key,w||(w="list-item-".concat(z)),s[z]=w,L(d,z)},Ie=function(){return!!(I||e||F)},Oe=function(d,z){return t.exports.createElement("div",{className:"".concat(d,"-empty-text")},X&&X.emptyText||z("List"))},v=ae("list",o),V=O;typeof V=="boolean"&&(V={spinning:V});var se=V&&V.spinning,Q="";switch(C){case"large":Q="lg";break;case"small":Q="sm";break}var ze=de(v,(r={},j(r,"".concat(v,"-vertical"),P==="vertical"),j(r,"".concat(v,"-").concat(Q),Q),j(r,"".concat(v,"-split"),x),j(r,"".concat(v,"-bordered"),b),j(r,"".concat(v,"-loading"),se),j(r,"".concat(v,"-grid"),!!c),j(r,"".concat(v,"-something-after-last-item"),Ie()),j(r,"".concat(v,"-rtl"),oe==="rtl"),r),E),T=R(R(R({},J),{total:N.length,current:S,pageSize:M}),e||{}),ge=Math.ceil(T.total/T.pageSize);T.current>ge&&(T.current=ge);var fe=e?t.exports.createElement("div",{className:"".concat(v,"-pagination")},t.exports.createElement(Ze,R({},T,{onChange:Be,onShowSizeChange:we}))):null,ie=xe(N);e&&N.length>(T.current-1)*T.pageSize&&(ie=xe(N).splice((T.current-1)*T.pageSize,T.pageSize));var ve=Qe(),Z=t.exports.useMemo(function(){for(var u=0;u<ke.length;u+=1){var d=ke[u];if(ve[d])return d}},[ve]),Fe=t.exports.useMemo(function(){if(!!c){var u=Z&&c[Z]?c[Z]:c.column;if(u)return{width:"".concat(100/u,"%"),maxWidth:"".concat(100/u,"%")}}},[c==null?void 0:c.column,Z]),le=se&&t.exports.createElement("div",{style:{minHeight:53}});if(ie.length>0){var he=ie.map(function(u,d){return je(u,d)}),Le=t.exports.Children.map(he,function(u,d){return t.exports.createElement("div",{key:s[d],style:Fe},u)});le=c?t.exports.createElement(Ve,{gutter:c.gutter},Le):t.exports.createElement("ul",{className:"".concat(v,"-items")},he)}else!m&&!se&&(le=Oe(v,_));var ee=T.position||"bottom";return t.exports.createElement(pe.Provider,{value:{grid:c,itemLayout:P}},t.exports.createElement("div",R({className:ze},D),(ee==="top"||ee==="both")&&fe,g&&t.exports.createElement("div",{className:"".concat(v,"-header")},g),t.exports.createElement(He,V,le,m),F&&t.exports.createElement("div",{className:"".concat(v,"-footer")},F),I||(ee==="bottom"||ee==="both")&&fe))}me.Item=tt;const gt=n=>{var J;const{mainnetProvider:r}=n,l=De(),e=_e(),o=Se(l),p=Se(l,e==null?void 0:e.signer),b=(J=e.account)!=null?J:"",i=o.Vendor,x=o.YourToken,E=p.Vendor,m=p.YourToken,P=t.exports.useContext(Je),I=Ye(e.chainId,"fast"),c=We(r),h=Ke(P,e==null?void 0:e.signer,I),[N,C]=t.exports.useState();Ce(async()=>{(async()=>{if(!x)return;const f=await x.balanceOf(b);console.log("\u{1F3F5} yourTokenBalance:",f?be(f):"..."),C(f)})()},{provider:r});const[g,F]=t.exports.useState();t.exports.useEffect(()=>{(async()=>{if(!i)return;const f=await i.tokensPerEth();console.log("\u{1F3E6} tokensPerEth:",f?f.toString():"..."),F(f.toNumber())})()},[i]);const A=Xe(x,{contractName:"YourToken",functionName:"allowance",functionArgs:[b,i==null?void 0:i.address]});console.log("\u{1F90F} vendorApproval",A);const[O,k]=t.exports.useState(""),[L,X]=t.exports.useState(),[D,B]=t.exports.useState(!1),[Y,q]=t.exports.useState(),[S,re]=t.exports.useState(),[G,W]=t.exports.useState(!1);t.exports.useEffect(()=>{console.log("tokenSellAmount",S);const s=S&&H(""+S);!s||(console.log("tokenSellAmountBN",s),A&&A[0].gte(s)?W(!0):W(!1),console.log("isSellAmountApproved",G))});let M=Ee.from(0);Y&&g&&(M=H(""+Y/parseFloat(g.toString()))),console.log("ethCostToPurchaseTokens:",M);let U=Ee.from(0);S&&g&&(U=H(""+S/parseFloat(g.toString()))),console.log("ethCostToPurchaseTokens:",M);const[K,ae]=t.exports.useState();Ce(async()=>{(async()=>{const f=await(x==null?void 0:x.balanceOf(i==null?void 0:i.address));console.log("\u{1F3F5} vendorTokenBalance:",f?be(f):"..."),ae(f)})()},{provider:r});let _=a(Pe,{});N&&(_=a("div",{style:{padding:8,marginTop:32,width:420,margin:"auto"},children:y(te,{title:"Transfer tokens",children:[y("div",{children:[a("div",{style:{padding:8},children:a(Ue,{ensProvider:r,placeholder:"to address",address:O,onChange:k})}),a("div",{style:{padding:8},children:a(ue,{style:{textAlign:"center"},placeholder:"amount of tokens to send",value:L,onChange:s=>{X(Number(s.target.value))}})})]}),a("div",{style:{padding:8},children:a(ne,{type:"primary",onClick:()=>{!h||h(m.transfer(O,H(""+L)))},children:"Send Tokens"})})]})}));const oe=qe(i,"BuyTokens",1);return y(Pe,{children:[a("div",{style:{padding:8,marginTop:32,width:300,margin:"auto"},children:a(te,{title:"Your Tokens",extra:a("a",{href:"#",children:"code"}),children:a("div",{style:{padding:8},children:a($,{balance:N,address:void 0})})})}),_,a(Te,{}),a("div",{style:{padding:8,marginTop:32,width:300,margin:"auto"},children:y(te,{title:"Buy Tokens",extra:a("a",{href:"#",children:"code"}),children:[y("div",{style:{padding:8},children:[g&&g," tokens per ETH"]}),y("div",{style:{padding:8},children:[a(ue,{style:{textAlign:"center"},placeholder:"amount of tokens to buy",value:Y,onChange:s=>{q(Number(s.target.value))}}),a($,{balance:M,dollarMultiplier:c,address:void 0})]}),a("div",{style:{padding:8},children:a(ne,{type:"primary",loading:D,onClick:async()=>{!h||(B(!0),await h(E.buyTokens({value:M})),B(!1))},children:"Buy Tokens"})})]})}),'Extra UI for buying the tokens back from the user using "approve" and "sellTokens"',a(Te,{}),a("div",{style:{padding:8,marginTop:32,width:300,margin:"auto"},children:y(te,{title:"Sell Tokens",children:[y("div",{style:{padding:8},children:[g&&g," tokens per ETH"]}),y("div",{style:{padding:8},children:[a(ue,{style:{textAlign:"center"},placeholder:"amount of tokens to sell",value:S,onChange:s=>{re(Number(s.target.value))}}),a($,{balance:U,dollarMultiplier:c,address:void 0})]}),G?a("div",{style:{padding:8},children:a(ne,{type:"primary",loading:D,onClick:async()=>{!h||!S||(B(!0),await h(E.sellTokens(H(S.toString()))),B(!1))},children:"Sell Tokens"})}):a("div",{style:{padding:8},children:a(ne,{type:"primary",loading:D,onClick:async()=>{!h||!S||(B(!0),await h(m.approve(o.Vendor.address,H(S.toString()))),B(!1))},children:"Approve Tokens"})})]})}),y("div",{style:{padding:8,marginTop:32},children:[a("div",{children:"Vendor Token Balance:"}),a($,{balance:K,address:void 0})]}),y("div",{style:{padding:8},children:[a("div",{children:"Vendor ETH Balance:"}),a($,{address:i==null?void 0:i.address})," ETH"]}),y("div",{style:{width:500,margin:"auto",marginTop:64},children:[a("div",{children:"Buy Token Events:"}),a(me,{dataSource:oe,renderItem:s=>y(me.Item,{children:[a(Ge,{address:s.args[0],ensProvider:r,fontSize:16})," paid",a($,{balance:s.args[1],address:void 0}),"ETH to get",a($,{balance:s.args[2],address:void 0}),"Tokens"]},s.blockNumber+s.blockHash)})]})]})};export{gt as YourToken};
